/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e,t,n,r,o={76:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAppPrint=void 0;var r=n(1239);function o(){var e;null===(e=r.getWindow())||void 0===e||e.print()}t.handleAppPrint=function(){var e;navigator.userAgent.indexOf("iOS")>=0?(e=function(){var e=r.getWindow();if(e&&e.document&&e.document.body){var t=e.document.createElement("input");return t.style.display="none",e.document.body.appendChild(t),t}}())&&(e.select(),o(),e.remove()):o()}},371:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9454),o=function(){function e(){this.map={}}return e.prototype.set=function(e,t){Object.prototype.hasOwnProperty.call(this.map,e)||(this.map[e]=[]);var n={handler:t,remove:function(){}},o=r.addAndRemoveFromCollection(this.map[e],n);return n={handler:t,remove:o},o},e.prototype.get=function(e){var t=this.map[e];return t?t.map((function(e){return e.handler})):void 0},e.prototype.run=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=0,s=this.get(e)||[];return function e(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var a=s[i++];return a?a(e).apply(n,r):t.apply(n,r)}.apply(n,r)},e}();t.default=o},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},627:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0,(n=t.Action||(t.Action={})).LARGEST_CONTENTFUL_PAINT="APP::WEB_VITALS::LARGEST_CONTENTFUL_PAINT",n.FIRST_INPUT_DELAY="APP::WEB_VITALS::FIRST_INPUT_DELAY",n.CUMULATIVE_LAYOUT_SHIFT="APP::WEB_VITALS::CUMULATIVE_LAYOUT_SHIFT",n.FIRST_CONTENTFUL_PAINT="APP::WEB_VITALS::FIRST_CONTENTFUL_PAINT",n.TIME_TO_FIRST_BYTE="APP::WEB_VITALS::TIME_TO_FIRST_BYTE",n.INTERACTION_TO_NEXT_PAINT="APP::WEB_VITALS::INTERACTION_TO_NEXT_PAINT"},904:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SEPARATOR=t.PREFIX=void 0,t.PREFIX="APP",t.SEPARATOR="::"},907:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Headers:()=>s,Request:()=>a,Response:()=>c,default:()=>i,fetch:()=>o});var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("unable to locate global object")}();const o=r.fetch,i=r.fetch.bind(r),s=r.Headers,a=r.Request,c=r.Response},1019:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(2617),t)},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1199:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockAppBridge=t.serverAppBridge=void 0;var r=n(7310),o=function(){},i=new Promise((function(){}));t.serverAppBridge={dispatch:function(){return{}},error:function(){return o},featuresAvailable:function(){return Promise.reject(r.fromAction("Feature detection is only available on the client side.",r.AppActionType.WINDOW_UNDEFINED))},getState:function(){return Promise.reject(r.fromAction("State is only available on the client side.",r.AppActionType.WINDOW_UNDEFINED))},localOrigin:"",hostOrigin:"",subscribe:function(){return o}},t.mockAppBridge={dispatch:function(){return{}},error:function(){return o},featuresAvailable:function(){return i},getState:function(){return i},localOrigin:"",hostOrigin:"",subscribe:function(){return o}}},1239:(e,t)=>{"use strict";function n(){return r()?window.location:void 0}function r(){return"undefined"!=typeof window}Object.defineProperty(t,"__esModule",{value:!0}),t.getWindow=t.getLocation=t.redirect=t.shouldRedirect=void 0,t.shouldRedirect=function(e){return e===window},t.redirect=function(e){var t=n();t&&t.assign(e)},t.getLocation=n,t.getWindow=function(){return r()?window:void 0}},1249:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(1601),o=n.n(r),i=n(6314),s=n.n(i)()(o());s.push([e.id,'/* Reset and base styles */\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n  line-height: 1.6;\n  color: #333;\n  background-color: #f7f7f7;\n}\n\n/* App container */\n.app-container {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n}\n\n/* Header styles */\nheader {\n  background-color: #4a90e2;\n  color: white;\n  text-align: center;\n  padding: 2rem 1rem;\n}\n\n.header-content {\n  max-width: 800px;\n  margin: 0 auto;\n}\n\nheader h1 {\n  margin-bottom: 0.5rem;\n  font-size: 2.5rem;\n}\n\nheader p {\n  font-size: 1.1rem;\n  opacity: 0.9;\n}\n\n/* Main content */\nmain {\n  flex: 1;\n  padding: 2rem 1rem;\n  max-width: 1200px;\n  margin: 0 auto;\n  width: 100%;\n}\n\n/* Search section */\n.search-section {\n  background-color: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n  padding: 2rem;\n  margin-bottom: 2rem;\n}\n\n.search-container {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 1rem;\n}\n\n.search-suggestions {\n  color: #777;\n  font-size: 0.9rem;\n}\n\n.search-suggestions span {\n  color: #4a90e2;\n  cursor: pointer;\n  margin: 0 3px;\n}\n\n.search-suggestions span:hover {\n  text-decoration: underline;\n}\n\ninput[type="text"] {\n  flex: 1;\n  padding: 0.8rem 1rem;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 1rem;\n}\n\nbutton {\n  background-color: #4a90e2;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 0.8rem 1.5rem;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: background-color 0.2s;\n}\n\nbutton:hover {\n  background-color: #3a7bd5;\n}\n\n/* Results section */\n.results-section {\n  background-color: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n  padding: 2rem;\n}\n\n.initial-message {\n  text-align: center;\n  color: #888;\n  padding: 2rem 0;\n}\n\n/* Product card styles */\n.product-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 1.5rem;\n}\n\n.product-card {\n  border: 1px solid #eee;\n  border-radius: 8px;\n  overflow: hidden;\n  transition: transform 0.2s, box-shadow 0.2s;\n  display: flex;\n  flex-direction: column;\n}\n\n.product-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\n}\n\n.product-image {\n  width: 100%;\n  height: 200px;\n  object-fit: cover;\n}\n\n.product-details {\n  padding: 1rem;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n}\n\n.product-name {\n  font-size: 1.1rem;\n  margin-bottom: 0.5rem;\n}\n\n.product-price {\n  font-weight: bold;\n  color: #4a90e2;\n  margin-bottom: 0.5rem;\n}\n\n.product-description {\n  color: #666;\n  font-size: 0.9rem;\n  margin-bottom: 1rem;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  flex: 1;\n}\n\n.product-link {\n  display: inline-block;\n  text-decoration: none;\n  color: white;\n  background-color: #4a90e2;\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  font-size: 0.9rem;\n  align-self: flex-start;\n  transition: background-color 0.2s;\n}\n\n.product-link:hover {\n  background-color: #3a7bd5;\n}\n\n/* Loading indicator */\n.loading {\n  text-align: center;\n  padding: 2rem 0;\n  color: #555;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.loading::after {\n  content: "â³";\n  font-size: 2rem;\n  animation: pulse 1.5s infinite;\n  display: inline-block;\n  margin-top: 1rem;\n}\n\n@keyframes pulse {\n  0% { opacity: 0.5; transform: scale(0.95); }\n  50% { opacity: 1; transform: scale(1.05); }\n  100% { opacity: 0.5; transform: scale(0.95); }\n}\n\n/* No results message */\n.no-results {\n  text-align: center;\n  padding: 2rem 0;\n  color: #888;\n}\n\n.no-results p {\n  margin-bottom: 0.5rem;\n}\n\n.no-results p:first-child {\n  font-size: 1.2rem;\n  color: #555;\n}\n\n/* Footer */\nfooter {\n  text-align: center;\n  padding: 1.5rem;\n  background-color: #333;\n  color: white;\n  font-size: 0.9rem;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .search-container {\n    flex-direction: column;\n  }\n\n  button {\n    width: 100%;\n  }\n\n  .product-grid {\n    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));\n  }\n}\n\n@media (max-width: 480px) {\n  header h1 {\n    font-size: 2rem;\n  }\n\n  .search-section, .results-section {\n    padding: 1.5rem;\n  }\n\n  .product-grid {\n    grid-template-columns: 1fr;\n  }\n}\n',""]);const a=s},1601:e=>{"use strict";e.exports=function(e){return e[1]}},1923:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPackageName=t.getVersion=t.getMergedProps=t.updateActionFromPayload=t.isValidOptionalString=t.isValidOptionalNumber=t.NonSnakeCaseGroup=t.getEventNameSpace=t.forEachInEnum=t.findMatchInEnum=t.actionWrapper=void 0;var r=n(5129);Object.defineProperty(t,"actionWrapper",{enumerable:!0,get:function(){return r.actionWrapper}}),Object.defineProperty(t,"findMatchInEnum",{enumerable:!0,get:function(){return r.findMatchInEnum}}),Object.defineProperty(t,"forEachInEnum",{enumerable:!0,get:function(){return r.forEachInEnum}}),Object.defineProperty(t,"getEventNameSpace",{enumerable:!0,get:function(){return r.getEventNameSpace}}),Object.defineProperty(t,"NonSnakeCaseGroup",{enumerable:!0,get:function(){return r.NonSnakeCaseGroup}}),Object.defineProperty(t,"isValidOptionalNumber",{enumerable:!0,get:function(){return r.isValidOptionalNumber}}),Object.defineProperty(t,"isValidOptionalString",{enumerable:!0,get:function(){return r.isValidOptionalString}}),Object.defineProperty(t,"updateActionFromPayload",{enumerable:!0,get:function(){return r.updateActionFromPayload}}),Object.defineProperty(t,"getMergedProps",{enumerable:!0,get:function(){return r.getMergedProps}});var o=n(5024);t.getVersion=function(){return o.version},t.getPackageName=function(){return o.name}},1961:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(5045)),i=r(n(3825)),s=n(3530);class a{constructor(e,{headers:t={},schema:n,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new o.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:r=!1,count:o}={}){let s;const a=new URL(`${this.url}/rpc/${e}`);let c;n||r?(s=n?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{a.searchParams.append(e,t)}))):(s="POST",c=t);const l=Object.assign({},this.headers);return o&&(l.Prefer=`count=${o}`),new i.default({method:s,url:a,headers:l,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}}t.default=a},2279:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const o=r(n(1961));t.PostgrestClient=o.default;const i=r(n(5045));t.PostgrestQueryBuilder=i.default;const s=r(n(3825));t.PostgrestFilterBuilder=s.default;const a=r(n(8261));t.PostgrestTransformBuilder=a.default;const c=r(n(4279));t.PostgrestBuilder=c.default;const l=r(n(6818));t.PostgrestError=l.default,t.default={PostgrestClient:o.default,PostgrestQueryBuilder:i.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:c.default,PostgrestError:l.default}},2558:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentType=t.Group=void 0;var r=n(6336);Object.defineProperty(t,"Group",{enumerable:!0,get:function(){return r.Group}}),Object.defineProperty(t,"ComponentType",{enumerable:!0,get:function(){return r.ComponentType}})},2572:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.permissionAction=t.isErrorEventName=t.throwError=t.invalidOriginAction=t.fromAction=t.AppBridgeError=t.AppActionType=t.Action=void 0;var r,o,i=n(6336),s=n(5129);!function(e){e.INVALID_ACTION="APP::ERROR::INVALID_ACTION",e.INVALID_ACTION_TYPE="APP::ERROR::INVALID_ACTION_TYPE",e.INVALID_PAYLOAD="APP::ERROR::INVALID_PAYLOAD",e.INVALID_OPTIONS="APP::ERROR::INVALID_OPTIONS",e.UNEXPECTED_ACTION="APP::ERROR::UNEXPECTED_ACTION",e.PERSISTENCE="APP::ERROR::PERSISTENCE",e.UNSUPPORTED_OPERATION="APP::ERROR::UNSUPPORTED_OPERATION",e.NETWORK="APP::ERROR::NETWORK",e.PERMISSION="APP::ERROR::PERMISSION",e.FAILED_AUTHENTICATION="APP::ERROR::FAILED_AUTHENTICATION",e.INVALID_ORIGIN="APP::ERROR::INVALID_ORIGIN"}(r=t.Action||(t.Action={})),(o=t.AppActionType||(t.AppActionType={})).INVALID_CONFIG="APP::ERROR::INVALID_CONFIG",o.MISSING_CONFIG="APP::APP_ERROR::MISSING_CONFIG",o.MISSING_APP_BRIDGE_MIDDLEWARE="APP::APP_ERROR::MISSING_APP_BRIDGE_MIDDLEWARE",o.WINDOW_UNDEFINED="APP::APP_ERROR::WINDOW_UNDEFINED",o.REDUX_REINSTANTIATED="APP::APP_ERROR::REDUX_REINSTANTIATED",o.MISSING_LOCAL_ORIGIN="APP::APP_ERROR::MISSING_LOCAL_ORIGIN",o.MISSING_HOST_PROVIDER="APP::APP_ERROR::MISSING_HOST_PROVIDER",o.MISSING_ROUTER_CONTEXT="APP::APP_ERROR::MISSING_ROUTER_CONTEXT",o.MISSING_HISTORY_BLOCK="APP::APP_ERROR::MISSING_HISTORY_BLOCK";var a=function(e){this.name="AppBridgeError",this.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(this.message).stack};function c(e,t,n){var r=new a(e?t+": "+e:t);return r.action=n,r.type=t,r}t.AppBridgeError=a,a.prototype=Object.create(Error.prototype),t.fromAction=c,t.invalidOriginAction=function(e){return s.actionWrapper({group:i.Group.Error,payload:{message:e,type:r.INVALID_ORIGIN},type:r.INVALID_ORIGIN})},t.throwError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r,o=e[0];throw"string"==typeof e[1]?n=e[1]:(r=e[1],n=e[2]||""),c(n,o,r)},t.isErrorEventName=function(e){return"string"==typeof s.findMatchInEnum(r,e)},t.permissionAction=function(e,t){return function(e,t,n){var r=t.payload;return s.actionWrapper({type:e,group:i.Group.Error,payload:{action:t,message:n,type:e,id:r&&r.id?r.id:void 0}})}(r.PERMISSION,e,t||"Action is not permitted")}},2617:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTransportListener=t.fromWindow=t.fromFrame=t.Context=void 0;var r,o=n(2572),i=n(6023),s=n(2952),a=n(4984),c=n(2801);(r=t.Context||(t.Context={})).Modal="Modal",r.Main="Main",t.fromFrame=function(e,t,n){var r=[],s=e.host,l=e.window;if(!s)throw o.fromAction("App frame is undefined",o.AppActionType.WINDOW_UNDEFINED);return c.isUnframed&&window.MobileWebView&&Object.assign(window.MobileWebView,{postMessageToIframe:function(e,t){null==l||l.postMessage(e,t),function(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&"dispatch"===e.type&&"object"==typeof e.payload}(e)&&s.postMessage(JSON.stringify(e.payload),location.origin)},updateIframeUrl:function(n){var r=window.location,o=(e.window||{}).location;try{new URL(n).origin===t&&o?o.replace(n):r.href=n}catch(e){}}}),s.addEventListener("message",(function(e){if(e.source!==s&&i.isAppMessage(e))if(e.origin===t)if(c.isUnframed&&window.MobileWebView)u=JSON.stringify({id:"unframed://fromClient",origin:t,data:e.data}),window.MobileWebView.postMessage(u);else for(var n=0,a=r;n<a.length;n++)(0,a[n])(e);else{var u,d="Message origin '"+e.origin+"' does not match app origin '"+t+"'.",h={type:"dispatch",payload:u=o.invalidOriginAction(d)};null==l||l.postMessage(h,e.origin)}})),{context:n,localOrigin:t,frameWindow:l,hostFrame:s,dispatch:function(e){null==l||l.postMessage(e,t)},subscribe:function(e){return a.addAndRemoveFromCollection(r,e)}}},t.fromWindow=function(e,t){var n=[];return void 0!==typeof window&&window.addEventListener("message",(function(t){if((window!==e||c.isUnframed)&&t.source===e&&(i.isAppBridgeAction(t.data.payload)||i.isAppMessage(t)))for(var r=0,o=n;r<o.length;r++)(0,o[r])(t)})),{localOrigin:t,hostFrame:e,dispatch:function(n){var r;if(null===(r=n.source)||void 0===r?void 0:r.host)if(c.isUnframed&&window&&window.MobileWebView){var o=JSON.stringify({id:"unframed://fromClient",origin:t,data:n});window.MobileWebView.postMessage(o)}else{var i=new URL("https://"+n.source.host).origin;e.postMessage(n,i)}},subscribe:function(e){return a.addAndRemoveFromCollection(n,e)}}},t.createTransportListener=function(){var e=[],t={};return{createSubscribeHandler:function(n){return function(){if(arguments.length<2)return a.addAndRemoveFromCollection(e,{callback:arguments[0]});var r=Array.from(arguments),o=r[0],i=r[1],c=r[2],l={callback:i,id:c},u={type:o,id:c};return Object.prototype.hasOwnProperty.call(t,o)||(t[o]=[]),n&&n(s.MessageType.Subscribe,u),a.addAndRemoveFromCollection(t[o],l,(function(){n&&n(s.MessageType.Unsubscribe,u)}))}},handleMessage:function(t){e.forEach((function(e){return e.callback(t)}))},handleActionDispatch:function(e){var n=e.type,r=e.payload,o=!1;if(Object.prototype.hasOwnProperty.call(t,n))for(var i=0,s=t[n];i<s.length;i++){var a=s[i],c=a.id,l=a.callback;(!r||r.id!==c)&&c||(l(r),o=!0)}return o}}}},2801:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.isUnframed=t.isClient=t.isServer=void 0,t.isServer="undefined"==typeof window,t.isClient=!t.isServer,t.isUnframed=t.isClient&&(null===(r=null===(n=window.navigator)||void 0===n?void 0:n.userAgent)||void 0===r?void 0:r.indexOf("Unframed"))>0},2952:(e,t)=>{"use strict";var n,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.LifecycleHook=t.PermissionType=t.MessageType=void 0,(o=t.MessageType||(t.MessageType={})).GetState="getState",o.Dispatch="dispatch",o.Subscribe="subscribe",o.Unsubscribe="unsubscribe",(r=t.PermissionType||(t.PermissionType={})).Dispatch="Dispatch",r.Subscribe="Subscribe",(n=t.LifecycleHook||(t.LifecycleHook={})).UpdateAction="UpdateAction",n.DispatchAction="DispatchAction"},3530:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const r=n(4519);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`}},3825:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(8261));class i extends o.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:r}={}){let o="";"plain"===r?o="pl":"phrase"===r?o="ph":"websearch"===r&&(o="w");const i=void 0===n?"":`(${n})`;return this.url.searchParams.append(e,`${o}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}}t.default=i},3919:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.app=t.Action=void 0;var r=n(4621);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return r.Action}}),Object.defineProperty(t,"app",{enumerable:!0,get:function(){return r.app}})},4217:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0,(t.Action||(t.Action={})).INITIALIZE="APP::CLIENT::INITIALIZE"},4279:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(907)),i=r(n(6818));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=o.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,n,r;let o=null,s=null,a=null,c=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(s="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),i=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&i&&i.length>1&&(a=parseInt(i[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(s)&&(s.length>1?(o={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,a=null,c=406,l="Not Acceptable"):s=1===s.length?s[0]:null)}else{const t=await e.text();try{o=JSON.parse(t),Array.isArray(o)&&404===e.status&&(s=[],o=null,c=200,l="OK")}catch(n){404===e.status&&""===t?(c=204,l="No Content"):o={message:t}}if(o&&this.isMaybeSingle&&(null===(r=null==o?void 0:o.details)||void 0===r?void 0:r.includes("0 rows"))&&(o=null,c=200,l="OK"),o&&this.shouldThrowOnError)throw new i.default(o)}return{error:o,data:s,count:a,status:c,statusText:l}}));return this.shouldThrowOnError||(n=n.catch((e=>{var t,n,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(n=null==e?void 0:e.stack)&&void 0!==n?n:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},4519:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},4621:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.app=t.Action=void 0;var r,o=n(5129),i=n(6336);!function(e){e.APP="APP::PRINT::APP"}(r=t.Action||(t.Action={})),t.app=function(){return o.actionWrapper({group:i.Group.Print,type:r.APP})}},4984:(e,t)=>{"use strict";function n(e,t,n){var r=e.findIndex((function(e){return e===t}));return r>=0&&(e.splice(r,1),n&&n(t),!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.removeFromCollection=t.addAndRemoveFromCollection=void 0,t.addAndRemoveFromCollection=function(e,t,r){return e.push(t),function(){return n(e,t,r)}},t.removeFromCollection=n},5024:e=>{"use strict";e.exports=JSON.parse('{"name":"@shopify/app-bridge","version":"3.7.10","types":"index.d.ts","main":"index.js","unpkg":"umd/index.js","jsdelivr":"umd/index.js","files":["/actions/","/client/","/umd/","/utilities/","/util/","/validate/","/development.d.ts","/development.js","/index.d.ts","/index.js","/MessageTransport.d.ts","/MessageTransport.js","/production.d.ts","/production.js"],"private":false,"publishConfig":{"access":"public","@shopify:registry":"https://registry.npmjs.org"},"repository":"git@github.com:Shopify/app-bridge.git","homepage":"https://shopify.dev/docs/api/app-bridge/previous-versions/app-bridge-from-npm/app-setup","author":"Shopify Inc.","license":"MIT","scripts":{"build":"yarn build:tsc && yarn build:npm && yarn build:umd","build:tsc":"NODE_ENV=production tsc","build:umd":"NODE_ENV=production webpack -p","build:npm":"shx cp -r ./npm/index.js ./index.js","check":"tsc","clean":"yarn clean:tsc && yarn clean:npm && yarn clean:umd","clean:tsc":"NODE_ENV=production tsc --build --clean","clean:umd":"rm -rf ./umd","clean:npm":"rm -rf ./index.js","pack":"yarn pack","size":"size-limit"},"sideEffects":false,"size-limit":[{"limit":"10.5 KB","path":"production.js"}],"dependencies":{"@shopify/app-bridge-core":"1.1.1","base64url":"^3.0.1","web-vitals":"^3.0.1"},"devDependencies":{"@types/node":"^10.12.5","shx":"^0.3.3"}}')},5045:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3825));t.default=class{constructor(e,{headers:t={},schema:n,fetch:r}){this.url=e,this.headers=t,this.schema=n,this.fetch=r}select(e,{head:t=!1,count:n}={}){const r=t?"HEAD":"GET";let i=!1;const s=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e))).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new o.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new o.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:i=!0}={}){const s=[`resolution=${n?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),i||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new o.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new o.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new o.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},5056:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},s=[],a=0;a<e.length;a++){var c=e[a],l=r.base?c[0]+r.base:c[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var h=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=o(p,r);r.byIndex=a,t.splice(a,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var a=n(i[s]);t[a].references--}for(var c=r(e,o),l=0;l<i.length;l++){var u=n(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},5129:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateActionFromPayload=t.isValidOptionalString=t.isValidOptionalNumber=t.forEachInEnum=t.getMergedProps=t.findMatchInEnum=t.getEventNameSpace=t.NonSnakeCaseGroup=t.actionWrapper=void 0;var o=r(n(8613)),i=n(904),s=n(6336);function a(e,t){return o.default(e,t)||Object.assign(e,t)}t.actionWrapper=function(e){return e},t.NonSnakeCaseGroup=[s.Group.AuthCode,s.Group.Button,s.Group.ButtonGroup,s.Group.Cart,s.Group.Error,s.Group.Features,s.Group.Fullscreen,s.Group.Link,s.Group.Loading,s.Group.Menu,s.Group.Modal,s.Group.Navigation,s.Group.Pos,s.Group.Print,s.Group.ResourcePicker,s.Group.Scanner,s.Group.SessionToken,s.Group.Share,s.Group.TitleBar,s.Group.Toast,s.Group.unstable_Picker],t.getEventNameSpace=function(e,n,r){if(n.startsWith(""+i.PREFIX+i.SEPARATOR))return n;var o=function(e){return t.NonSnakeCaseGroup.includes(e)?e.toUpperCase():(n=e,n.replace(/([A-Z])/g,(function(e,t,n){return(0===n?"":"_")+e[0].toLowerCase()}))).toUpperCase();var n}(e);if(r){var s=r.subgroups,a=r.type;s&&s.length>0&&(o+=o.length>0?i.SEPARATOR:"",s.forEach((function(e,t){o+=""+e.toUpperCase()+(t<s.length-1?i.SEPARATOR:"")}))),a!==e&&a&&(o+=""+(o.length>0?i.SEPARATOR:"")+a.toUpperCase())}return o&&(o+=""+(o.length>0?i.SEPARATOR:"")+n.toUpperCase()),""+i.PREFIX+i.SEPARATOR+o},t.findMatchInEnum=function(e,t){var n=Object.keys(e).find((function(n){return t===e[n]}));return n?e[n]:void 0},t.getMergedProps=a,t.forEachInEnum=function(e,t){Object.keys(e).forEach((function(n){t(e[n])}))},t.isValidOptionalNumber=function(e){return null==e||"number"==typeof e},t.isValidOptionalString=function(e){return null==e||"string"==typeof e},t.updateActionFromPayload=function(e,t){return e.id===t.id&&(Object.assign(e,a(e,t)),!0)}},5345:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShopifyPing=t.isShopifyPOS=t.isShopifyMobile=t.isShopifyEmbedded=t.isMobile=void 0;var r=n(8559);function o(){return"undefined"!=typeof navigator&&navigator.userAgent.indexOf("Shopify Mobile")>=0}function i(){return"undefined"!=typeof navigator&&navigator.userAgent.indexOf("Shopify POS")>=0}function s(){return"undefined"!=typeof navigator&&navigator.userAgent.indexOf("Shopify Ping")>=0}t.isMobile=function(){return o()||i()||s()},t.isShopifyEmbedded=function(){return r.isClient&&window.top!==window.self||r.isUnframed},t.isShopifyMobile=o,t.isShopifyPOS=i,t.isShopifyPing=s},5606:e=>{var t,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var a,c=[],l=!1,u=-1;function d(){l&&a&&(l=!1,a.length?c=a.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(a=c,c=[];++u<t;)a&&a[u].run();u=-1,t=c.length}a=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},5824:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(8355);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.createApp}}),o(n(1019),t),o(n(8355),t)},6023:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPermitted=t.getPermissionKey=t.isPerformanceOrWebVitalsAction=t.isAppMessage=t.isAppBridgeAction=void 0;var r=n(2952),o=n(904),i=n(5129);function s(e){return e.replace(new RegExp("^"+o.PREFIX+o.SEPARATOR+"\\w+"+o.SEPARATOR),"")}t.isAppBridgeAction=function(e){return e instanceof Object&&Object.prototype.hasOwnProperty.call(e,"type")&&e.type.toString().startsWith(o.PREFIX)},t.isAppMessage=function(e){if("object"!=typeof e||!e.data||"object"!=typeof e.data)return!1;var t=e.data;return Object.prototype.hasOwnProperty.call(t,"type")&&void 0!==i.findMatchInEnum(r.MessageType,t.type)},t.isPerformanceOrWebVitalsAction=function(e){return e.type.match(/^APP::(PERFORMANCE|WEB_VITALS)::/)},t.getPermissionKey=s,t.isPermitted=function(e,t,n){var r=t.group,o=t.type;if(!r||!Object.prototype.hasOwnProperty.call(e,r))return!1;var i=e[r];if(!i)return!1;var a=s(o);return!!i[a]&&!0===i[a][n]}},6029:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(8142),t)},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);r&&s[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},6336:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentType=t.Group=void 0,(r=t.Group||(t.Group={})).AuthCode="AuthCode",r.Button="Button",r.ButtonGroup="ButtonGroup",r.Cart="Cart",r.Client="Client",r.ContextualSaveBar="ContextualSaveBar",r.Error="Error",r.Features="Features",r.FeedbackModal="FeedbackModal",r.Fullscreen="Fullscreen",r.LeaveConfirmation="LeaveConfirmation",r.Link="Link",r.Loading="Loading",r.Menu="Menu",r.Modal="Modal",r.Navigation="Navigation",r.Performance="Performance",r.Pos="Pos",r.Print="Print",r.ResourcePicker="Resource_Picker",r.unstable_Picker="unstable_Picker",r.Scanner="Scanner",r.SessionToken="SessionToken",r.Share="Share",r.TitleBar="TitleBar",r.Toast="Toast",r.MarketingExternalActivityTopBar="MarketingExternalActivityTopBar",r.WebVitals="WebVitals",(n=t.ComponentType||(t.ComponentType={})).Button="Button",n.ButtonGroup="ButtonGroup"},6684:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createApp=t.createAppWrapper=t.createClientApp=t.WINDOW_UNDEFINED_MESSAGE=void 0;var s=n(1923),a=n(3919),c=n(7310),l=n(1019),u=n(1199),d=n(8559),h=n(7687),p=n(6029),f=n(76),m=n(1239),g=n(8066),v=i(n(371));t.WINDOW_UNDEFINED_MESSAGE="window is not defined. Running an app outside a browser is not supported";var b=function(e){return function(t){return e(r(r({},t),{version:s.getVersion(),clientInterface:{name:s.getPackageName(),version:s.getVersion()}}))}},y=function(e){e.set(g.LifecycleHook.DispatchAction,b)};function _(e,n,r){if(void 0===r&&(r=[]),!e)throw c.fromAction(t.WINDOW_UNDEFINED_MESSAGE,c.AppActionType.WINDOW_UNDEFINED);var i=m.getLocation(),s=n||i&&i.origin;if(!s)throw c.fromAction("local origin cannot be blank",c.AppActionType.MISSING_LOCAL_ORIGIN);var a=l.fromWindow(e,s);return t.createClientApp(a,o([y],r))}function w(e){var t=m.getWindow();return t&&t.top?_(t.top)(e):u.serverAppBridge}t.createClientApp=function(e,t){void 0===t&&(t=[]);var n=[],i=l.createTransportListener();return e.subscribe((function(e){var t=e.data,r=t.type,o=t.payload;switch(r){case"getState":n.splice(0).forEach((function(e){return e(o)}));break;case"dispatch":if(i.handleMessage(o),i.handleActionDispatch(o))return;var a=s.findMatchInEnum(c.Action,o.type);a&&c.throwError(a,o)}})),function(l){var b=function(e){var t;if(!e.host)throw c.fromAction("host must be provided",c.AppActionType.INVALID_CONFIG);if(!e.apiKey)throw c.fromAction("apiKey must be provided",c.AppActionType.INVALID_CONFIG);try{var n=atob(null===(t=e.host)||void 0===t?void 0:t.replace(/_/g,"/").replace(/-/g,"+"));return r(r({},e),{host:n})}catch(e){throw c.fromAction("not a valid host, please use the value provided by Shopify",c.AppActionType.INVALID_CONFIG)}}(l),y=function(e,t){var n=t.apiKey,r=t.host,o=t.forceRedirect,i=void 0===o?!d.isDevelopmentClient:o,s=m.getLocation();if(d.isUnframed||!s||!n||!r||!i||!m.shouldRedirect(e))return!1;var a="https://"+r+"/apps/"+n+s.pathname+(s.search||"");return m.redirect(a),!0}(e.hostFrame,b);if(y)return u.mockAppBridge;var _=function(e,t){return function(n,r){e.dispatch({payload:r,source:t,type:n})}}(e,b),w=i.createSubscribeHandler(_);function S(e){return _(g.MessageType.Dispatch,e),e}_(g.MessageType.Unsubscribe);for(var E=new URL("https://"+b.host).origin,T=new v.default,A={hostOrigin:E,localOrigin:e.localOrigin,hooks:T,dispatch:function(e){return A.hooks?A.hooks.run(g.LifecycleHook.DispatchAction,S,A,e):S(e)},featuresAvailable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=Array.isArray(n)?o([],n):e;return A.getState("features").then((function(e){return r.length?r.reduce((function(t,n){return Object.keys(e).includes(n)&&(t[n]=e[n]),t}),{}):e}))},getState:function(e){return e&&"string"!=typeof e?Promise.resolve(void 0):new Promise((function(e){n.push(e),_(g.MessageType.GetState)})).then((function(t){var n=t;if(e)for(var r=0,o=e.split(".");r<o.length;r++){var i=o[r];if(null==n||"object"!=typeof n||Array.isArray(n)||!Object.keys(n).includes(i))return;n=n[i]}return n}))},subscribe:w,error:function(e,t){var n=[];return s.forEachInEnum(c.Action,(function(r){n.push(w(r,e,t))})),function(){n.forEach((function(e){return e()}))}}},O=0,k=t;O<k.length;O++)(0,k[O])(T,A);return function(e){e.subscribe(a.Action.APP,f.handleAppPrint),e.dispatch(h.initialize());try{p.initializeWebVitals(e)}catch(e){console.error("App-Bridge failed to initialize web-vitals",e)}}(A),A}},t.createAppWrapper=_,t.createApp=w,t.default=w},6791:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(1601),o=n.n(r),i=n(6314),s=n.n(i)()(o());s.push([e.id,"/* Chat Widget Styles */\n.chat-widget-container {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  width: 350px;\n  height: 500px;\n  background-color: #fff;\n  border-radius: 10px;\n  box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  z-index: 1000;\n  transition: all 0.3s ease;\n}\n\n.chat-widget-container.minimized {\n  height: 50px;\n}\n\n.chat-widget-header {\n  background-color: #4a90e2;\n  color: white;\n  padding: 12px 15px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.chat-widget-header h3 {\n  margin: 0;\n  font-size: 18px;\n}\n\n.toggle-button {\n  background: transparent;\n  border: none;\n  color: white;\n  font-size: 20px;\n  cursor: pointer;\n  padding: 0 5px;\n  line-height: 1;\n}\n\n.chat-messages {\n  flex: 1;\n  overflow-y: auto;\n  padding: 15px;\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n}\n\n.minimized .chat-messages {\n  display: none;\n}\n\n.message {\n  max-width: 80%;\n  padding: 10px 15px;\n  border-radius: 15px;\n  position: relative;\n  animation: fadeIn 0.3s ease;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(10px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n.user-message {\n  align-self: flex-end;\n  background-color: #4a90e2;\n  color: white;\n  border-bottom-right-radius: 5px;\n}\n\n.assistant-message {\n  align-self: flex-start;\n  background-color: #f1f1f1;\n  color: #333;\n  border-bottom-left-radius: 5px;\n}\n\n.message-content {\n  word-break: break-word;\n}\n\n.message-content p {\n  margin: 0;\n  line-height: 1.4;\n}\n\n.message-time {\n  font-size: 10px;\n  opacity: 0.8;\n  margin-top: 5px;\n  text-align: right;\n}\n\n.user-message .message-time {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.chat-input-container {\n  display: flex;\n  padding: 10px;\n  border-top: 1px solid #eee;\n  background-color: #fff;\n}\n\n.minimized .chat-input-container {\n  display: none;\n}\n\n.chat-input-container input {\n  flex: 1;\n  border: 1px solid #ddd;\n  border-radius: 20px;\n  padding: 8px 15px;\n  font-size: 14px;\n  outline: none;\n}\n\n.chat-input-container button {\n  background-color: #4a90e2;\n  color: white;\n  border: none;\n  border-radius: 20px;\n  padding: 8px 15px;\n  margin-left: 10px;\n  cursor: pointer;\n  font-size: 14px;\n  transition: background-color 0.2s;\n}\n\n.chat-input-container button:hover {\n  background-color: #3a7bd5;\n}\n\n.chat-input-container button:disabled {\n  background-color: #ccc;\n  cursor: not-allowed;\n}\n\n/* Loading indicator */\n.loading-indicator {\n  display: flex;\n  gap: 5px;\n  justify-content: center;\n  align-items: center;\n  padding: 10px;\n}\n\n.loading-indicator span {\n  display: inline-block;\n  width: 8px;\n  height: 8px;\n  background-color: #4a90e2;\n  border-radius: 50%;\n  animation: bounce 1.4s infinite ease-in-out both;\n}\n\n.loading-indicator span:nth-child(1) {\n  animation-delay: -0.32s;\n}\n\n.loading-indicator span:nth-child(2) {\n  animation-delay: -0.16s;\n}\n\n@keyframes bounce {\n  0%, 80%, 100% {\n    transform: scale(0);\n  } 40% {\n    transform: scale(1.0);\n  }\n}\n\n/* Product cards in chat */\n.product-cards-container {\n  display: flex;\n  flex-direction: column;\n  gap: 15px;\n  margin: 10px 0;\n  width: 100%;\n}\n\n.product-card-chat {\n  border: 1px solid #eee;\n  border-radius: 8px;\n  overflow: hidden;\n  background-color: white;\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n}\n\n.product-card-chat img {\n  width: 100%;\n  height: 120px;\n  object-fit: cover;\n}\n\n.product-card-details {\n  padding: 10px;\n}\n\n.product-card-title {\n  font-weight: bold;\n  margin-bottom: 5px;\n  font-size: 14px;\n}\n\n.product-card-price {\n  color: #4a90e2;\n  font-weight: bold;\n  margin-bottom: 5px;\n  font-size: 14px;\n}\n\n.product-card-description {\n  font-size: 12px;\n  color: #777;\n  margin-bottom: 10px;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.product-card-actions {\n  display: flex;\n  justify-content: space-between;\n}\n\n.product-card-button {\n  background-color: #4a90e2;\n  color: white;\n  border: none;\n  border-radius: 15px;\n  padding: 5px 10px;\n  font-size: 12px;\n  cursor: pointer;\n}\n\n.product-card-button:hover {\n  background-color: #3a7bd5;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .chat-widget-container {\n    width: 300px;\n    height: 450px;\n    bottom: 10px;\n    right: 10px;\n  }\n}\n\n@media (max-width: 480px) {\n  .chat-widget-container {\n    width: calc(100% - 20px);\n    height: 400px;\n  }\n}\n",""]);const a=s},6818:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},7310:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.networkAction=t.persistenceAction=t.unsupportedOperationAction=t.unexpectedAction=t.invalidAction=t.invalidActionType=t.invalidPayload=t.Message=t.fromAction=t.Action=t.permissionAction=t.isErrorEventName=t.throwError=t.invalidOriginAction=t.AppBridgeError=t.AppActionType=void 0;var r=n(2572);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return r.Action}}),Object.defineProperty(t,"fromAction",{enumerable:!0,get:function(){return r.fromAction}});var o,i=n(1923),s=n(2558),a=n(2572);function c(e,t,n){var r=t.payload;return i.actionWrapper({type:e,group:s.Group.Error,payload:{action:t,message:n,type:e,id:r&&r.id?r.id:void 0}})}Object.defineProperty(t,"AppActionType",{enumerable:!0,get:function(){return a.AppActionType}}),Object.defineProperty(t,"AppBridgeError",{enumerable:!0,get:function(){return a.AppBridgeError}}),Object.defineProperty(t,"invalidOriginAction",{enumerable:!0,get:function(){return a.invalidOriginAction}}),Object.defineProperty(t,"throwError",{enumerable:!0,get:function(){return a.throwError}}),Object.defineProperty(t,"isErrorEventName",{enumerable:!0,get:function(){return a.isErrorEventName}}),Object.defineProperty(t,"permissionAction",{enumerable:!0,get:function(){return a.permissionAction}}),(o=t.Message||(t.Message={})).MISSING_PAYLOAD="Missing payload",o.INVALID_PAYLOAD_ID="Id in payload is missing or invalid",t.invalidPayload=function(e,t){return c(r.Action.INVALID_PAYLOAD,e,t||"The action's payload is missing required properties or has invalid properties")},t.invalidActionType=function(e,t){return i.actionWrapper({group:s.Group.Error,payload:{action:e,message:t||"The action type is invalid or unsupported",type:r.Action.INVALID_ACTION_TYPE},type:r.Action.INVALID_ACTION_TYPE})},t.invalidAction=function(e,t){return i.actionWrapper({group:s.Group.Error,payload:{action:e,message:t||"The action's has missing/invalid values for `group`, `type` or `version`",type:r.Action.INVALID_ACTION},type:r.Action.INVALID_ACTION})},t.unexpectedAction=function(e,t){return i.actionWrapper({group:s.Group.Error,payload:{action:e,message:t||"Action cannot be called at this time",type:r.Action.UNEXPECTED_ACTION},type:r.Action.UNEXPECTED_ACTION})},t.unsupportedOperationAction=function(e,t){return c(r.Action.UNSUPPORTED_OPERATION,e,t||"The action type is unsupported")},t.persistenceAction=function(e,t){return c(r.Action.PERSISTENCE,e,t||"Action cannot be persisted on server")},t.networkAction=function(e,t){return c(r.Action.NETWORK,e,t||"Network error")}},7659:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},7687:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.Action=void 0;var r=n(4217);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return r.Action}});var o=n(2558),i=n(1923);t.initialize=function(){return i.actionWrapper({group:o.Group.Client,type:r.Action.INITIALIZE})}},7795:()=>{var e=null,t=null,n=null,r=null,o=[{id:1,name:"Wireless Noise-Cancelling Headphones",price:249.99,description:"Premium wireless headphones with active noise cancellation, 30-hour battery life, and comfortable over-ear design.",image:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?auto=format&w=500",link:"#product-1"},{id:2,name:"Smart Fitness Watch",price:199.99,description:"Track your workouts, heart rate, sleep, and more with this advanced fitness tracker. Water-resistant and week-long battery life.",image:"https://images.unsplash.com/photo-1579586337278-3befd40fd17a?auto=format&w=500",link:"#product-2"},{id:3,name:"Organic Cotton T-Shirt",price:29.99,description:"Soft, comfortable t-shirt made from 100% organic cotton. Available in multiple colors and sizes.",image:"https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&w=500",link:"#product-3"},{id:4,name:"Professional Blender",price:129.99,description:"High-performance blender with multiple speed settings. Perfect for smoothies, soups, and more.",image:"https://images.unsplash.com/photo-1570222094114-d054a817e56b?auto=format&w=500",link:"#product-4"},{id:5,name:"Leather Wallet",price:49.99,description:"Genuine leather wallet with multiple card slots and RFID blocking technology.",image:"https://images.unsplash.com/photo-1627123424574-724758594e93?auto=format&w=500",link:"#product-5"},{id:6,name:"Digital Camera",price:699.99,description:"24MP digital camera with 4K video recording capability and interchangeable lenses.",image:"https://images.unsplash.com/photo-1516035069371-29a1b244cc32?auto=format&w=500",link:"#product-6"}];function i(){try{if(console.log("app.js init called"),e=document.getElementById("search-form"),t=document.getElementById("search-input"),n=document.getElementById("results-container"),r=document.querySelectorAll(".search-suggestions span"),console.log("Elements found:",{searchForm:!!e,searchInput:!!t,resultsContainer:!!n,searchSuggestions:r?r.length:0}),!e||!t||!n)return void console.error("Required elements not found in app.js - skipping search form initialization");try{e.addEventListener("submit",s),console.log("Added submit listener to search form")}catch(e){console.error("Error adding submit listener to search form:",e)}if(r&&r.length>0)try{r.forEach((function(n){n.addEventListener("click",(function(){t.value=n.textContent,e.dispatchEvent(new Event("submit"))}))})),console.log("Added click listeners to search suggestions")}catch(e){console.error("Error adding click listeners to search suggestions:",e)}console.log("Search form initialization completed successfully")}catch(e){console.error("Error during app initialization:",e)}}function s(e){e.preventDefault();var r=t.value.trim().toLowerCase();if(!r)return void(n&&(n.innerHTML='<div class="initial-message">'.concat("Please enter a search term","</div>")));n&&(n.innerHTML='<div class="loading">Searching for products...</div>'),setTimeout((function(){var e=function(e){return o.filter((function(t){return t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)}))}(r);!function(e,t){if(n.innerHTML="",0!==e.length){var r=document.createElement("div");r.className="product-grid",e.forEach((function(e){var t=function(e){var t=document.createElement("div");return t.className="product-card",t.innerHTML='\n    <img src="'.concat(e.image,'" alt="').concat(e.name,'" class="product-image">\n    <div class="product-details">\n      <h3 class="product-name">').concat(e.name,'</h3>\n      <p class="product-price">$').concat(e.price.toFixed(2),'</p>\n      <p class="product-description">').concat(e.description,'</p>\n      <a href="').concat(e.link,'" class="product-link">View Product</a>\n    </div>\n  '),t}(e);r.appendChild(t)})),n.appendChild(r)}else!function(e){n&&(n.innerHTML='\n      <div class="no-results">\n        <p>No products found matching "'.concat(e,'"</p>\n        <p>Try different keywords or browse our featured products.</p>\n      </div>\n    '))}(t)}(e,r)}),800)}document.addEventListener("DOMContentLoaded",(function(){console.log("DOM content loaded, initializing app with small delay"),setTimeout(i,100)})),window.addEventListener("load",(function(){console.log("Window loaded, initializing app if not already initialized"),e||(console.log("SearchForm not initialized yet, running init again"),setTimeout(i,100))}))},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},8066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isV1Config=t.MessageType=t.LifecycleHook=t.PermissionType=void 0;var r=n(2952);Object.defineProperty(t,"MessageType",{enumerable:!0,get:function(){return r.MessageType}});var o=n(2952);Object.defineProperty(t,"PermissionType",{enumerable:!0,get:function(){return o.PermissionType}}),Object.defineProperty(t,"LifecycleHook",{enumerable:!0,get:function(){return o.LifecycleHook}}),t.isV1Config=function(e){return!e.host}},8142:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWebVitals=t.interactionToNextPaint=t.timeToFirstByte=t.firstContentfulPaint=t.cumulativeLayoutShift=t.firstInputDelay=t.largestContentfulPaint=t.Action=void 0;var r=n(8796),o=n(627);Object.defineProperty(t,"Action",{enumerable:!0,get:function(){return o.Action}});var i=n(8559),s=n(2558),a=n(1923),c=n(5345);function l(e){return a.actionWrapper({group:s.Group.WebVitals,type:o.Action.LARGEST_CONTENTFUL_PAINT,payload:e})}function u(e){return a.actionWrapper({group:s.Group.WebVitals,type:o.Action.FIRST_INPUT_DELAY,payload:e})}function d(e){return a.actionWrapper({group:s.Group.WebVitals,type:o.Action.CUMULATIVE_LAYOUT_SHIFT,payload:e})}function h(e){return a.actionWrapper({group:s.Group.WebVitals,type:o.Action.FIRST_CONTENTFUL_PAINT,payload:e})}function p(e){return a.actionWrapper({group:s.Group.WebVitals,type:o.Action.TIME_TO_FIRST_BYTE,payload:e})}function f(e){return a.actionWrapper({group:s.Group.WebVitals,type:o.Action.INTERACTION_TO_NEXT_PAINT,payload:e})}t.largestContentfulPaint=l,t.firstInputDelay=u,t.cumulativeLayoutShift=d,t.firstContentfulPaint=h,t.timeToFirstByte=p,t.interactionToNextPaint=f,t.initializeWebVitals=function(e){function t(t){return function(n){var r=n.id,o=n.name,i=n.value,s=t({id:r,metricName:o,value:i});e.dispatch(s)}}var n=window;i.isServer||i.isClient&&n.__is_web_vitals_initialized__||c.isMobile()||(n.__is_web_vitals_initialized__=!0,r.onLCP(t(l)),r.onFID(t(u)),r.onCLS(t(d)),r.onFCP(t(h)),r.onTTFB(t(p)),r.onINP(t(f)))}},8261:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(4279));class i extends o.default{select(e){let t=!1;const n=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:o=r}={}){const i=o?`${o}.order`:"order",s=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===n?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const r=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:r=n}={}){const o=void 0===r?"offset":`${r}.offset`,i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:o=!1,format:i="text"}={}){var s;const a=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,o?"wal":null].filter(Boolean).join("|"),c=null!==(s=this.headers.Accept)&&void 0!==s?s:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=i},8355:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6684);o(n(8066),t),o(n(6684),t),t.default=i.createClientApp},8559:(e,t,n)=>{"use strict";var r=n(5606);Object.defineProperty(t,"__esModule",{value:!0}),t.isDevelopmentClient=t.isProduction=t.isDevelopment=t.isUnframed=t.isServer=t.isClient=void 0;var o=n(2801),i=n(2801);Object.defineProperty(t,"isClient",{enumerable:!0,get:function(){return i.isClient}}),Object.defineProperty(t,"isServer",{enumerable:!0,get:function(){return i.isServer}}),Object.defineProperty(t,"isUnframed",{enumerable:!0,get:function(){return i.isUnframed}}),t.isDevelopment=void 0!==r&&{NVM_INC:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/include/node",TERM_PROGRAM:"vscode",NODE:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",INIT_CWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",NVM_CD_FLAGS:"-q",PYENV_ROOT:"/Users/renatoboemer/.pyenv",TERM:"xterm-256color",SHELL:"/bin/zsh",TMPDIR:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/",npm_config_global_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",TERM_PROGRAM_VERSION:"0.48.9",ZDOTDIR:"/Users/renatoboemer",CURSOR_TRACE_ID:"cdf90b5ac0d14854963123fad7ea0247",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/renatoboemer/code/developer/ai-shopping-shopify",PNPM_HOME:"/Users/renatoboemer/Library/pnpm",PYTHONBREAKPOINT:"ipdb.set_trace",LC_ALL:"en_US.UTF-8",NVM_DIR:"/Users/renatoboemer/.nvm",USER:"renatoboemer",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/etc/npmrc",HOMEBREW_NO_ANALYTICS:"1",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.HMAZGRSvi9/Listeners",PYENV_VIRTUALENV_DISABLE_PROMPT:"1",__CF_USER_TEXT_ENCODING:"0x1F5:0:2",npm_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/bin/npm-cli.js",PYENV_VIRTUALENV_INIT:"1",VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",PAGER:"less",PYENV_VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin:/Users/renatoboemer/code/developer/node_modules/.bin:/Users/renatoboemer/code/node_modules/.bin:/Users/renatoboemer/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.pyenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/Users/renatoboemer/Library/pnpm:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter",npm_package_json:"/Users/renatoboemer/code/developer/ai-shopping-shopify/package.json",_:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin/webpack",npm_config_userconfig:"/Users/renatoboemer/.npmrc",npm_config_init_module:"/Users/renatoboemer/.npm-init.js",USER_ZDOTDIR:"/Users/renatoboemer",__CFBundleIdentifier:"com.todesktop.230313mzl4w4u92",npm_command:"run-script",PWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",npm_lifecycle_event:"build",EDITOR:"code",npm_package_name:"ai-shopping-shopify",LANG:"en_US.UTF-8",npm_config_npm_version:"10.8.2",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_package_engines_node:"18.x || 20.x",npm_config_node_gyp:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",PYENV_SHELL:"zsh",SHLVL:"2",HOME:"/Users/renatoboemer",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",BUNDLER_EDITOR:"code",npm_config_cache:"/Users/renatoboemer/.npm",LESS:"-R",LOGNAME:"renatoboemer",npm_lifecycle_script:"webpack --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/vscode-git-19ee989870.sock",NVM_BIN:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin",npm_config_user_agent:"npm/10.8.2 node/v20.18.3 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Cursor.app/Contents/Frameworks/Cursor Helper (Plugin).app/Contents/MacOS/Cursor Helper (Plugin)",GIT_ASKPASS:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass.sh",npm_node_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",npm_config_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",COLORTERM:"truecolor"}&&!1,t.isProduction=!t.isDevelopment,t.isDevelopmentClient=t.isDevelopment&&o.isClient},8613:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){if(null==n)return n;if(void 0===t||!Object.prototype.isPrototypeOf.call(Object.getPrototypeOf(t),n)||"Object"!==n.constructor.name&&"Array"!==n.constructor.name)return n;var r={};return Object.keys(n).forEach((function(o){Object.prototype.hasOwnProperty.call(t,o)?"object"!=typeof t[o]||Array.isArray(t[o])?r[o]=n[o]:r[o]=e(t[o],n[o]):r[o]=n[o]})),Object.keys(t).forEach((function(e){Object.prototype.hasOwnProperty.call(n,e)||(r[e]=t[e])})),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}},8796:function(e,t){!function(e){"use strict";var t,n,r,o,i,s=-1,a=function(e){addEventListener("pageshow",(function(t){t.persisted&&(s=t.timeStamp,e(t))}),!0)},c=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},l=function(){var e=c();return e&&e.activationStart||0},u=function(e,t){var n=c(),r="navigate";return s>=0?r="back-forward-cache":n&&(document.prerendering||l()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},d=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},h=function(e,t,n,r){var o,i;return function(s){t.value>=0&&(s||r)&&((i=t.value-(o||0))||void 0===o)&&(o=t.value,t.delta=i,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},p=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},f=function(e){var t=function(t){"pagehide"!==t.type&&"hidden"!==document.visibilityState||e(t)};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},m=function(e){var t=!1;return function(n){t||(e(n),t=!0)}},g=-1,v=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},b=function(e){"hidden"===document.visibilityState&&g>-1&&(g="visibilitychange"===e.type?e.timeStamp:0,_())},y=function(){addEventListener("visibilitychange",b,!0),addEventListener("prerenderingchange",b,!0)},_=function(){removeEventListener("visibilitychange",b,!0),removeEventListener("prerenderingchange",b,!0)},w=function(){return g<0&&(g=v(),y(),a((function(){setTimeout((function(){g=v(),y()}),0)}))),{get firstHiddenTime(){return g}}},S=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},E=[1800,3e3],T=function(e,t){t=t||{},S((function(){var n,r=w(),o=u("FCP"),i=d("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(i.disconnect(),e.startTime<r.firstHiddenTime&&(o.value=Math.max(e.startTime-l(),0),o.entries.push(e),n(!0)))}))}));i&&(n=h(e,o,E,t.reportAllChanges),a((function(r){o=u("FCP"),n=h(e,o,E,t.reportAllChanges),p((function(){o.value=performance.now()-r.timeStamp,n(!0)}))})))}))},A=[.1,.25],O=function(e,t){t=t||{},T(m((function(){var n,r=u("CLS",0),o=0,i=[],s=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=i[0],n=i[i.length-1];o&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,i.push(e)):(o=e.value,i=[e])}})),o>r.value&&(r.value=o,r.entries=i,n())},c=d("layout-shift",s);c&&(n=h(e,r,A,t.reportAllChanges),f((function(){s(c.takeRecords()),n(!0)})),a((function(){o=0,r=u("CLS",0),n=h(e,r,A,t.reportAllChanges),p((function(){return n()}))})),setTimeout(n,0))})))},k={passive:!0,capture:!0},P=new Date,I=function(e,o){t||(t=o,n=e,r=new Date,R(removeEventListener),x())},x=function(){if(n>=0&&n<r-P){var e={entryType:"first-input",name:t.type,target:t.target,cancelable:t.cancelable,startTime:t.timeStamp,processingStart:t.timeStamp+n};o.forEach((function(t){t(e)})),o=[]}},C=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){I(e,t),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,k),removeEventListener("pointercancel",r,k)};addEventListener("pointerup",n,k),addEventListener("pointercancel",r,k)}(t,e):I(t,e)}},R=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,C,k)}))},L=[100,300],N=function(e,r){r=r||{},S((function(){var i,s=w(),c=u("FID"),l=function(e){e.startTime<s.firstHiddenTime&&(c.value=e.processingStart-e.startTime,c.entries.push(e),i(!0))},p=function(e){e.forEach(l)},g=d("first-input",p);i=h(e,c,L,r.reportAllChanges),g&&f(m((function(){p(g.takeRecords()),g.disconnect()}))),g&&a((function(){var s;c=u("FID"),i=h(e,c,L,r.reportAllChanges),o=[],n=-1,t=null,R(addEventListener),s=l,o.push(s),x()}))}))},U=0,j=1/0,M=0,D=function(e){e.forEach((function(e){e.interactionId&&(j=Math.min(j,e.interactionId),M=Math.max(M,e.interactionId),U=M?(M-j)/7+1:0)}))},F=function(){return i?U:performance.interactionCount||0},$=function(){"interactionCount"in performance||i||(i=d("event",D,{type:"event",buffered:!0,durationThreshold:0}))},G=[200,500],V=0,B=function(){return F()-V},H=[],z={},W=function(e){var t=H[H.length-1],n=z[e.interactionId];if(n||H.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};z[r.id]=r,H.push(r)}H.sort((function(e,t){return t.latency-e.latency})),H.splice(10).forEach((function(e){delete z[e.id]}))}},q=function(e,t){t=t||{},S((function(){var n;$();var r,o=u("INP"),i=function(e){e.forEach((function(e){e.interactionId&&W(e),"first-input"===e.entryType&&!H.some((function(t){return t.entries.some((function(t){return e.duration===t.duration&&e.startTime===t.startTime}))}))&&W(e)}));var t,n=(t=Math.min(H.length-1,Math.floor(B()/50)),H[t]);n&&n.latency!==o.value&&(o.value=n.latency,o.entries=n.entries,r())},s=d("event",i,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});r=h(e,o,G,t.reportAllChanges),s&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&s.observe({type:"first-input",buffered:!0}),f((function(){i(s.takeRecords()),o.value<0&&B()>0&&(o.value=0,o.entries=[]),r(!0)})),a((function(){H=[],V=F(),o=u("INP"),r=h(e,o,G,t.reportAllChanges)})))}))},K=[2500,4e3],J={},Y=function(e,t){t=t||{},S((function(){var n,r=w(),o=u("LCP"),i=function(e){var t=e[e.length-1];t&&t.startTime<r.firstHiddenTime&&(o.value=Math.max(t.startTime-l(),0),o.entries=[t],n())},s=d("largest-contentful-paint",i);if(s){n=h(e,o,K,t.reportAllChanges);var c=m((function(){J[o.id]||(i(s.takeRecords()),s.disconnect(),J[o.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return setTimeout(c,0)}),!0)})),f(c),a((function(r){o=u("LCP"),n=h(e,o,K,t.reportAllChanges),p((function(){o.value=performance.now()-r.timeStamp,J[o.id]=!0,n(!0)}))}))}}))},X=[800,1800],Z=function e(t){document.prerendering?S((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},Q=function(e,t){t=t||{};var n=u("TTFB"),r=h(e,n,X,t.reportAllChanges);Z((function(){var o=c();if(o){var i=o.responseStart;if(i<=0||i>performance.now())return;n.value=Math.max(i-l(),0),n.entries=[o],r(!0),a((function(){n=u("TTFB",0),(r=h(e,n,X,t.reportAllChanges))(!0)}))}}))};e.CLSThresholds=A,e.FCPThresholds=E,e.FIDThresholds=L,e.INPThresholds=G,e.LCPThresholds=K,e.TTFBThresholds=X,e.getCLS=O,e.getFCP=T,e.getFID=N,e.getINP=q,e.getLCP=Y,e.getTTFB=Q,e.onCLS=O,e.onFCP=T,e.onFID=N,e.onINP=q,e.onLCP=Y,e.onTTFB=Q}(t)},9454:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeFromCollection=t.addAndRemoveFromCollection=void 0;var r=n(4984);Object.defineProperty(t,"addAndRemoveFromCollection",{enumerable:!0,get:function(){return r.addAndRemoveFromCollection}}),Object.defineProperty(t,"removeFromCollection",{enumerable:!0,get:function(){return r.removeFromCollection}})}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,exports:{}};return o[e].call(n.exports,n,n.exports,s),n.exports}s.m=o,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);s.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>e+".bundle.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="ai-shopping-shopify:",s.l=(e,t,o,i)=>{if(n[e])n[e].push(t);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==r+o){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",r+o),a.src=e),n[e]=[t];var h=(t,r)=>{a.onerror=a.onload=null,clearTimeout(p);var o=n[e];if(delete n[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(r))),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={792:0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=s.p+s.u(t),a=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[i,a,c]=n,l=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);c&&c(s)}for(t&&t(n);l<i.length;l++)o=i[l],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkai_shopping_shopify=self.webpackChunkai_shopping_shopify||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0,(()=>{"use strict";var e=s(5072),t=s.n(e),n=s(7825),r=s.n(n),o=s(7659),i=s.n(o),a=s(5056),c=s.n(a),l=s(540),u=s.n(l),d=s(1113),h=s.n(d),p=s(1249),f={};f.styleTagTransform=h(),f.setAttributes=c(),f.insert=i().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=u(),t()(p.A,f),p.A&&p.A.locals&&p.A.locals;var m,g=s(6791),v={};v.styleTagTransform=h(),v.setAttributes=c(),v.insert=i().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=u(),t()(g.A,v),g.A&&g.A.locals&&g.A.locals,s(7795);class b extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class y extends b{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _ extends b{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class w extends b{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(m||(m={}));class S{constructor(e,{headers:t={},customFetch:n,region:r=m.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n,r,o,i,s;return r=this,o=void 0,s=function*(){try{const{headers:r,method:o,body:i}=t;let s,a={},{region:c}=t;c||(c=this.region),c&&"any"!==c&&(a["x-region"]=c),i&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",s=i):"string"==typeof i?(a["Content-Type"]="text/plain",s=i):"undefined"!=typeof FormData&&i instanceof FormData?s=i:(a["Content-Type"]="application/json",s=JSON.stringify(i)));const l=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),r),body:s}).catch((e=>{throw new y(e)})),u=l.headers.get("x-relay-error");if(u&&"true"===u)throw new _(l);if(!l.ok)throw new w(l);let d,h=(null!==(n=l.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return d="application/json"===h?yield l.json():"application/octet-stream"===h?yield l.blob():"text/event-stream"===h?l:"multipart/form-data"===h?yield l.formData():yield l.text(),{data:d,error:null}}catch(e){return{data:null,error:e}}},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(n,a)}c((s=s.apply(r,o||[])).next())}))}}var E=s(2279);const{PostgrestClient:T,PostgrestQueryBuilder:A,PostgrestFilterBuilder:O,PostgrestTransformBuilder:k,PostgrestBuilder:P,PostgrestError:I}=E,x={"X-Client-Info":"realtime-js/2.11.2"};var C,R,L,N,U,j,M;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(C||(C={})),(M=R||(R={})).closed="closed",M.errored="errored",M.joined="joined",M.joining="joining",M.leaving="leaving",function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(L||(L={})),function(e){e.websocket="websocket"}(N||(N={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(U||(U={}));class D{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),o=t.getUint8(2);let i=this.HEADER_LENGTH+2;const s=n.decode(e.slice(i,i+r));i+=r;const a=n.decode(e.slice(i,i+o));return i+=o,{ref:null,topic:s,event:a,payload:JSON.parse(n.decode(e.slice(i,e.byteLength)))}}}class F{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(j||(j={}));const $=(e,t,n={})=>{var r;const o=null!==(r=n.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((n,r)=>(n[r]=G(r,e,t,o),n)),{})},G=(e,t,n,r)=>{const o=t.find((t=>t.name===e)),i=null==o?void 0:o.type,s=n[e];return i&&!r.includes(i)?V(i,s):B(s)},V=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return q(t,n)}switch(e){case j.bool:return H(t);case j.float4:case j.float8:case j.int2:case j.int4:case j.int8:case j.numeric:case j.oid:return z(t);case j.json:case j.jsonb:return W(t);case j.timestamp:return K(t);case j.abstime:case j.date:case j.daterange:case j.int4range:case j.int8range:case j.money:case j.reltime:case j.text:case j.time:case j.timestamptz:case j.timetz:case j.tsrange:case j.tstzrange:default:return B(t)}},B=e=>e,H=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},z=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},W=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},q=(e,t)=>{if("string"!=typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const o=e.slice(1,n);try{r=JSON.parse("["+o+"]")}catch(e){r=o?o.split(","):[]}return r.map((e=>V(t,e)))}return e},K=e=>"string"==typeof e?e.replace(" ","T"):e,J=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Y{constructor(e,t,n={},r=1e4){this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var X,Z,Q,ee;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(X||(X={}));class te{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=te.syncState(this.state,e,t,n),this.pendingDiffs.forEach((e=>{this.state=te.syncDiff(this.state,e,t,n)})),this.pendingDiffs=[],r()})),this.channel._on(n.diff,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=te.syncDiff(this.state,e,t,n),r())})),this.onJoin(((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})})),this.onLeave(((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,n,r){const o=this.cloneDeep(e),i=this.transformState(t),s={},a={};return this.map(o,((e,t)=>{i[e]||(a[e]=t)})),this.map(i,((e,t)=>{const n=o[e];if(n){const r=t.map((e=>e.presence_ref)),o=n.map((e=>e.presence_ref)),i=t.filter((e=>o.indexOf(e.presence_ref)<0)),c=n.filter((e=>r.indexOf(e.presence_ref)<0));i.length>0&&(s[e]=i),c.length>0&&(a[e]=c)}else s[e]=t})),this.syncDiff(o,{joins:s,leaves:a},n,r)}static syncDiff(e,t,n,r){const{joins:o,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(o,((t,r)=>{var o;const i=null!==(o=e[t])&&void 0!==o?o:[];if(e[t]=this.cloneDeep(r),i.length>0){const n=e[t].map((e=>e.presence_ref)),r=i.filter((e=>n.indexOf(e.presence_ref)<0));e[t].unshift(...r)}n(t,i,r)})),this.map(i,((t,n)=>{let o=e[t];if(!o)return;const i=n.map((e=>e.presence_ref));o=o.filter((e=>i.indexOf(e.presence_ref)<0)),e[t]=o,r(t,o,n),0===o.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((n=>t(n,e[n])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(Z||(Z={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(Q||(Q={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(ee||(ee={}));class ne{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=R.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Y(this,L.join,this.params,this.timeout),this.rejoinTimer=new F((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=R.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=R.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=R.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=R.errored,this.rejoinTimer.scheduleTimeout())})),this._on(L.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new te(this),this.broadcastEndpointURL=J(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:o,presence:i,private:s}}=this.params;this._onError((t=>null==e?void 0:e(ee.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(ee.CLOSED)));const a={},c={broadcast:o,presence:i,postgres_changes:null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map((e=>e.filter)))&&void 0!==r?r:[],private:s};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var n;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,o=null!==(n=null==r?void 0:r.length)&&void 0!==n?n:0,i=[];for(let n=0;n<o;n++){const o=r[n],{filter:{event:s,schema:a,table:c,filter:l}}=o,u=t&&t[n];if(!u||u.event!==s||u.schema!==a||u.table!==c||u.filter!==l)return this.unsubscribe(),void(null==e||e(ee.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},o),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e(ee.SUBSCRIBED))}null==e||e(ee.SUBSCRIBED)})).receive("error",(t=>{null==e||e(ee.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(ee.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((n=>{var r,o,i;const s=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(o=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===o?void 0:o.broadcast)||void 0===i?void 0:i.ack)||n("ok"),s.receive("ok",(()=>n("ok"))),s.receive("error",(()=>n("error"))),s.receive("timeout",(()=>n("timed out")))}));{const{event:o,payload:i}=e,s={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){return"AbortError"===e.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=R.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(L.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((n=>{const r=new Y(this,L.leave,{},e);r.receive("ok",(()=>{t(),n("ok")})).receive("timeout",(()=>{t(),n("timed out")})).receive("error",(()=>{n("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,n){const r=new AbortController,o=setTimeout((()=>r.abort()),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(o),i}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Y(this,e,t,n);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,o;const i=e.toLocaleLowerCase(),{close:s,error:a,leave:c,join:l}=L;if(n&&[s,a,c,l].indexOf(i)>=0&&n!==this._joinRef())return;let u=this._onMessage(i,t,n);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===i})).map((e=>e.callback(u,n))):null===(o=this.bindings[i])||void 0===o||o.filter((e=>{var n,r,o,s,a,c;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,s=null===(n=e.filter)||void 0===n?void 0:n.event;return i&&(null===(r=t.ids)||void 0===r?void 0:r.includes(i))&&("*"===s||(null==s?void 0:s.toLocaleLowerCase())===(null===(o=t.data)||void 0===o?void 0:o.type.toLocaleLowerCase()))}{const n=null===(a=null===(s=null==e?void 0:e.filter)||void 0===s?void 0:s.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===n||n===(null===(c=null==t?void 0:t.event)||void 0===c?void 0:c.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i})).map((e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:n,commit_timestamp:r,type:o,errors:i}=e,s={schema:t,table:n,commit_timestamp:r,eventType:o,new:{},old:{},errors:i};u=Object.assign(Object.assign({},s),this._getPayloadRecords(e))}e.callback(u,n)}))}_isClosed(){return this.state===R.closed}_isJoined(){return this.state===R.joined}_isJoining(){return this.state===R.joining}_isLeaving(){return this.state===R.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const r=e.toLocaleLowerCase(),o={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&ne.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(L.close,{},e)}_onError(e){this._on(L.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=R.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=$(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=$(e.columns,e.old_record)),t}}const re=()=>{},oe="undefined"!=typeof WebSocket;class ie{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=x,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=re,this.conn=null,this.sendBuffer=[],this.serializer=new D,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${N.websocket}`,this.httpEndpoint=J(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(n=null==t?void 0:t.params)||void 0===n?void 0:n.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new F((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(oe)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new se(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),s.e(591).then(s.t.bind(s,1591,23)).then((({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case C.connecting:return U.Connecting;case C.open:return U.Open;case C.closing:return U.Closing;default:return U.Closed}}isConnected(){return this.connectionState()===U.Open}channel(e,t={config:{}}){const n=new ne(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:r,ref:o}=e,i=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${n} (${o})`,r),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(e){}if(e&&e.exp&&!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`);this.accessTokenValue=t,this.channels.forEach((e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(L.access_token,{access_token:t})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:n,payload:r,ref:o}=e;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${n} ${o&&"("+o+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(n,r,o))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(L.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?";return`${e}${n}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class se{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=C.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class ae extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ce(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class le extends ae{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ue extends ae{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const de=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},he=e=>{if(Array.isArray(e))return e.map((e=>he(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,n])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=he(n)})),t};var pe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const fe=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),me=(e,t,n)=>pe(void 0,void 0,void 0,(function*(){const r=yield(o=void 0,i=void 0,a=void 0,c=function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(s.bind(s,907))).Response:Response},new(a||(a=Promise))((function(e,t){function n(e){try{s(c.next(e))}catch(e){t(e)}}function r(e){try{s(c.throw(e))}catch(e){t(e)}}function s(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a((function(e){e(o)}))).then(n,r)}s((c=c.apply(o,i||[])).next())})));var o,i,a,c;e instanceof r&&!(null==n?void 0:n.noResolveJson)?e.json().then((n=>{t(new le(fe(n),e.status||500))})).catch((e=>{t(new ue(fe(e),e))})):t(new ue(fe(e),e))}));function ge(e,t,n,r,o,i){return pe(this,void 0,void 0,(function*(){return new Promise(((s,a)=>{e(n,((e,t,n,r)=>{const o={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?o:(o.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(o.body=JSON.stringify(r)),Object.assign(Object.assign({},o),n))})(t,r,o,i)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>s(e))).catch((e=>me(e,a,r)))}))}))}function ve(e,t,n,r){return pe(this,void 0,void 0,(function*(){return ge(e,"GET",t,n,r)}))}function be(e,t,n,r,o){return pe(this,void 0,void 0,(function*(){return ge(e,"POST",t,r,o,n)}))}function ye(e,t,n,r,o){return pe(this,void 0,void 0,(function*(){return ge(e,"DELETE",t,r,o,n)}))}var _e=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const we={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Se={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ee{constructor(e,t={},n,r){this.url=e,this.headers=t,this.bucketId=n,this.fetch=de(r)}uploadOrUpdate(e,t,n,r){return _e(this,void 0,void 0,(function*(){try{let o;const i=Object.assign(Object.assign({},Se),r);let s=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const a=i.metadata;"undefined"!=typeof Blob&&n instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),a&&o.append("metadata",this.encodeMetadata(a)),o.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(o=n,o.append("cacheControl",i.cacheControl),a&&o.append("metadata",this.encodeMetadata(a))):(o=n,s["cache-control"]=`max-age=${i.cacheControl}`,s["content-type"]=i.contentType,a&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==r?void 0:r.headers)&&(s=Object.assign(Object.assign({},s),r.headers));const c=this._removeEmptyFolders(t),l=this._getFinalPath(c),u=yield this.fetch(`${this.url}/object/${l}`,Object.assign({method:e,body:o,headers:s},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),d=yield u.json();return u.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}upload(e,t,n){return _e(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,n)}))}uploadToSignedUrl(e,t,n,r){return _e(this,void 0,void 0,(function*(){const o=this._removeEmptyFolders(e),i=this._getFinalPath(o),s=new URL(this.url+`/object/upload/sign/${i}`);s.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Se.upsert},r),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);const a=yield this.fetch(s.toString(),{method:"PUT",body:e,headers:i}),c=yield a.json();return a.ok?{data:{path:o,fullPath:c.Key},error:null}:{data:null,error:c}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}createSignedUploadUrl(e,t){return _e(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const o=yield be(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:r}),i=new URL(this.url+o.url),s=i.searchParams.get("token");if(!s)throw new ae("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:s},error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}update(e,t,n){return _e(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,n)}))}move(e,t,n){return _e(this,void 0,void 0,(function*(){try{return{data:yield be(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}copy(e,t,n){return _e(this,void 0,void 0,(function*(){try{return{data:{path:(yield be(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}createSignedUrl(e,t,n){return _e(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),o=yield be(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const i=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}createSignedUrls(e,t,n){return _e(this,void 0,void 0,(function*(){try{const r=yield be(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${o}`):null}))),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}download(e,t){return _e(this,void 0,void 0,(function*(){const n=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),o=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield ve(this.fetch,`${this.url}/${n}/${t}${o}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}info(e){return _e(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield ve(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:he(e),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}exists(e){return _e(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n){return pe(this,void 0,void 0,(function*(){return ge(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),undefined)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(ce(e)&&e instanceof ue){const t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}))}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],o=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==o&&r.push(o);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&r.push(s);let a=r.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${a}`)}}}remove(e){return _e(this,void 0,void 0,(function*(){try{return{data:yield ye(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}list(e,t,n){return _e(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},we),t),{prefix:e||""});return{data:yield be(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Te={"X-Client-Info":"storage-js/2.7.1"};var Ae=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class Oe{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},Te),t),this.fetch=de(n)}listBuckets(){return Ae(this,void 0,void 0,(function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}getBucket(e){return Ae(this,void 0,void 0,(function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}createBucket(e,t={public:!1}){return Ae(this,void 0,void 0,(function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}updateBucket(e,t){return Ae(this,void 0,void 0,(function*(){try{const n=yield function(e,t,n,r){return pe(this,void 0,void 0,(function*(){return ge(e,"PUT",t,r,undefined,n)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}emptyBucket(e){return Ae(this,void 0,void 0,(function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}deleteBucket(e){return Ae(this,void 0,void 0,(function*(){try{return{data:yield ye(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(ce(e))return{data:null,error:e};throw e}}))}}class ke extends Oe{constructor(e,t={},n){super(e,t,n)}from(e){return new Ee(this.url,this.headers,e,this.fetch)}}let Pe="";Pe="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Ie={headers:{"X-Client-Info":`supabase-js-${Pe}/2.49.4`}},xe={schema:"public"},Ce={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Re={};var Le=s(907);const Ne=e=>{let t;return t=e||("undefined"==typeof fetch?Le.default:fetch),(...e)=>t(...e)},Ue=(e,t,n)=>{const r=Ne(n),o="undefined"==typeof Headers?Le.Headers:Headers;return(n,i)=>{return s=void 0,a=void 0,l=function*(){var s;const a=null!==(s=yield t())&&void 0!==s?s:e;let c=new o(null==i?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),r(n,Object.assign(Object.assign({},i),{headers:c}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{o(l.next(e))}catch(e){t(e)}}function r(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof c?o:new c((function(e){e(o)}))).then(n,r)}o((l=l.apply(s,a||[])).next())}));var s,a,c,l}};const je="2.69.1",Me=3e4,De={"X-Client-Info":`gotrue-js/${je}`},Fe="X-Supabase-Api-Version",$e=Date.parse("2024-01-01T00:00:00.0Z"),Ge="2024-01-01",Ve=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Be extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function He(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class ze extends Be{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class We extends Be{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class qe extends Be{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class Ke extends qe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Je extends qe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ye extends qe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Xe extends qe{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ze extends qe{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qe extends qe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function et(e){return He(e)&&"AuthRetryableFetchError"===e.name}class tt extends qe{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class nt extends qe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ot=" \t\n\r=".split(""),it=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ot.length;t+=1)e[ot[t].charCodeAt(0)]=-2;for(let t=0;t<rt.length;t+=1)e[rt[t].charCodeAt(0)]=t;return e})();function st(e,t,n){const r=it[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function at(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},i=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,r,n)};for(let t=0;t<e.length;t+=1)st(e.charCodeAt(t),o,i);return t.join("")}function ct(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function lt(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)st(e.charCodeAt(t),n,r);return new Uint8Array(t)}const ut=()=>"undefined"!=typeof window&&"undefined"!=typeof document,dt={tested:!1,writable:!1},ht=()=>{if(!ut())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(dt.tested)return dt.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),dt.tested=!0,dt.writable=!0}catch(e){dt.tested=!0,dt.writable=!1}return dt.writable},pt=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(s.bind(s,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},ft=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},mt=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(e){return n}},gt=async(e,t)=>{await e.removeItem(t)};class vt{constructor(){this.promise=new vt.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function bt(e){const t=e.split(".");if(3!==t.length)throw new nt("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!Ve.test(t[e]))throw new nt("JWT not in base64url format");return{header:JSON.parse(at(t[0])),payload:JSON.parse(at(t[1])),signature:lt(t[2]),raw:{header:t[0],payload:t[1]}}}function yt(e){return("0"+e.toString(16)).substr(-2)}async function _t(e,t,n=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,yt).join("")}();let o=r;n&&(o+="/PASSWORD_RECOVERY"),await ft(e,`${t}-code-verifier`,o);const i=await async function(e){if("undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder)return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(r);return[i,r===i?"plain":"s256"]}vt.promiseConstructor=Promise;const wt=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const St=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Et=[502,503,504];async function Tt(e){var t,n;if(!("object"==typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"==typeof n.json))throw new Qe(St(e),0);if(Et.includes(e.status))throw new Qe(St(e),e.status);let r,o;try{r=await e.json()}catch(e){throw new We(St(e),e)}const i=function(e){const t=e.headers.get(Fe);if(!t)return null;if(!t.match(wt))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=$e&&"object"==typeof r&&r&&"string"==typeof r.code?o=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(o=r.error_code),o){if("weak_password"===o)throw new tt(St(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===o)throw new Ke}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new tt(St(r),e.status,r.weak_password.reasons);throw new ze(St(r),e.status||500,o)}async function At(e,t,n,r){var o;const i=Object.assign({},null==r?void 0:r.headers);i[Fe]||(i[Fe]=Ge),(null==r?void 0:r.jwt)&&(i.Authorization=`Bearer ${r.jwt}`);const s=null!==(o=null==r?void 0:r.query)&&void 0!==o?o:{};(null==r?void 0:r.redirectTo)&&(s.redirect_to=r.redirectTo);const a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await async function(e,t,n,r,o,i){const s=((e,t,n,r)=>{const o={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),n))})(t,r,{},i);let a;try{a=await e(n,Object.assign({},s))}catch(e){throw console.error(e),new Qe(St(e),0)}if(a.ok||await Tt(a),null==r?void 0:r.noResolveJson)return a;try{return await a.json()}catch(e){await Tt(e)}}(e,t,n+a,{headers:i,noResolveJson:null==r?void 0:r.noResolveJson},0,null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(c):{data:Object.assign({},c),error:null}}function Ot(e){var t;let n=null;var r;return function(e){return e.access_token&&e.refresh_token&&e.expires_in}(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r))),{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function kt(e){const t=Ot(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function Pt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function It(e){return{data:e,error:null}}function xt(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:o,verification_type:i}=e,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:o,verification_type:i},user:Object.assign({},s)},error:null}}function Ct(e){return e}class Rt{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=pt(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await At(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(He(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await At(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Pt})}catch(e){if(He(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{const{options:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null==n?void 0:n.newEmail,delete r.newEmail),await At(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:xt,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(He(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await At(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Pt})}catch(e){if(He(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,n,r,o,i,s,a;try{const c={nextPage:null,lastPage:0,total:0},l=await At(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(o=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==o?o:""},xform:Ct});if(l.error)throw l.error;const u=await l.json(),d=null!==(i=l.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(a=null===(s=l.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==a?a:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);c[`${n}Page`]=t})),c.total=parseInt(d)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(e){if(He(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await At(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Pt})}catch(e){if(He(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await At(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Pt})}catch(e){if(He(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await At(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Pt})}catch(e){if(He(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{const{data:t,error:n}=await At(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(e){if(He(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await At(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(He(e))return{data:null,error:e};throw e}}}const Lt={getItem:e=>ht()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{ht()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{ht()&&globalThis.localStorage.removeItem(e)}};function Nt(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const Ut=!!(globalThis&&ht()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class jt extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Mt extends jt{}async function Dt(e,t,n){Ut&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),Ut&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw Ut&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Mt(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ut)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}Ut&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{Ut&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Ft={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:De,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function $t(e,t,n){return await n()}class Gt{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Gt.nextInstanceID,Gt.nextInstanceID+=1,this.instanceID>0&&ut()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Ft),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Rt({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=pt(r.fetch),this.lock=r.lock||$t,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:ut()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Dt:this.lock=$t,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:ht()?this.storage=Lt:(this.memoryStorage={},this.storage=Nt(this.memoryStorage)):(this.memoryStorage={},this.storage=Nt(this.memoryStorage)),ut()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${je}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach(((e,n)=>{t[n]=e}))}catch(e){}return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),ut()&&this.detectSessionInUrl&&"none"!==n){const{data:r,error:o}=await this._getSessionFromURL(t,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),function(e){return He(e)&&"AuthImplicitGrantRedirectError"===e.name}(o)){const t=null===(e=o.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:s}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",s),await this._saveSession(i),setTimeout((async()=>{"recovery"===s?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return He(e)?{error:e}:{error:new We("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const o=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(n=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:Ot}),{data:i,error:s}=o;if(s||!i)return{data:{user:null,session:null},error:s};const a=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,n,r;try{let o;if("email"in e){const{email:n,password:r,options:i}=e;let s=null,a=null;"pkce"===this.flowType&&([s,a]=await _t(this.storage,this.storageKey)),o=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:s,code_challenge_method:a},xform:Ot})}else{if(!("phone"in e))throw new Ye("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:s}=e;o=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(n=null==s?void 0:s.data)&&void 0!==n?n:{},channel:null!==(r=null==s?void 0:s.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:Ot})}}const{data:i,error:s}=o;if(s||!i)return{data:{user:null,session:null},error:s};const a=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:o}=e;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:kt})}else{if(!("phone"in e))throw new Ye("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:o}=e;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:kt})}}const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r}):{data:{user:null,session:null},error:new Je}}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,n,r,o;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(o=e.options)||void 0===o?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await mt(this.storage,`${this.storageKey}-code-verifier`),[n,r]=(null!=t?t:"").split("/");try{const{data:t,error:o}=await At(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Ot});if(await gt(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:o}):{data:{user:null,session:null,redirectType:null},error:new Je}}catch(e){if(He(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:o,nonce:i}=e,s=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:r,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:Ot}),{data:a,error:c}=s;return c?{data:{user:null,session:null},error:c}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:c}):{data:{user:null,session:null},error:new Je}}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,n,r,o,i;try{if("email"in e){const{email:r,options:o}=e;let i=null,s=null;"pkce"===this.flowType&&([i,s]=await _t(this.storage,this.storageKey));const{error:a}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==o?void 0:o.data)&&void 0!==t?t:{},create_user:null===(n=null==o?void 0:o.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken},code_challenge:i,code_challenge_method:s},redirectTo:null==o?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:n}=e,{data:s,error:a}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(o=null==n?void 0:n.shouldCreateUser)||void 0===o||o,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},channel:null!==(i=null==n?void 0:n.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:a}}throw new Ye("You must provide either an email or phone number.")}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,n;try{let r,o;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,o=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:i,error:s}=await At(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:r,xform:Ot});if(s)throw s;if(!i)throw new Error("An error occurred on token verification.");const a=i.session,c=i.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,n,r;try{let o=null,i=null;return"pkce"===this.flowType&&([o,i]=await _t(this.storage,this.storageKey)),await At(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:It})}catch(e){if(He(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Ke;const{error:r}=await At(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:r,options:o}=e,{error:i}=await At(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},redirectTo:null==o?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:n,type:r,options:o}=e,{data:i,error:s}=await At(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:s}}throw new Ye("You must provide either an email or phone number and a type")}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await mt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,r)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,r))})}return{data:{session:e},error:null}}const{session:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,(async()=>await this._getUser())))}async _getUser(e){try{return e?await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Pt}):await this._useSession((async e=>{var t,n,r;const{data:o,error:i}=e;if(i)throw i;return(null===(t=o.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:Pt}):{data:{user:null},error:new Ke}}))}catch(e){if(He(e))return function(e){return He(e)&&"AuthSessionMissingError"===e.name}(e)&&(await this._removeSession(),await gt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async n=>{const{data:r,error:o}=n;if(o)throw o;if(!r.session)throw new Ke;const i=r.session;let s=null,a=null;"pkce"===this.flowType&&null!=e.email&&([s,a]=await _t(this.storage,this.storageKey));const{data:c,error:l}=await At(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:a}),jwt:i.access_token,xform:Pt});if(l)throw l;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(e){if(He(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ke;const t=Date.now()/1e3;let n=t,r=!0,o=null;const{payload:i}=bt(e.access_token);if(i.exp&&(n=i.exp,r=n<=t),r){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};o=t}else{const{data:r,error:i}=await this._getUser(e.access_token);if(i)throw i;o={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(e){if(He(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var n;if(!e){const{data:r,error:o}=t;if(o)throw o;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null==e?void 0:e.refresh_token))throw new Ke;const{session:r,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(e){if(He(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!ut())throw new Xe("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Xe(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Ze("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Xe("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ze("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:o,refresh_token:i,expires_in:s,expires_at:a,token_type:c}=e;if(!(o&&s&&i&&c))throw new Xe("No session defined in URL");const l=Math.round(Date.now()/1e3),u=parseInt(s);let d=l+u;a&&(d=parseInt(a));const h=d-l;1e3*h<=Me&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);const p=d-u;l-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,l):l-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,l);const{data:f,error:m}=await this._getUser(o);if(m)throw m;const g={provider_token:n,provider_refresh_token:r,access_token:o,expires_in:u,expires_at:d,refresh_token:i,token_type:c,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(e){if(He(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await mt(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var n;const{data:r,error:o}=t;if(o)return{error:o};const i=null===(n=r.session)||void 0===n?void 0:n.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return He(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await gt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession((async t=>{var n,r;try{const{data:{session:r},error:o}=t;if(o)throw o;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(t){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}}))}async resetPasswordForEmail(e,t={}){let n=null,r=null;"pkce"===this.flowType&&([n,r]=await _t(this.storage,this.storageKey,!0));try{return await At(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(He(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(He(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{const{data:n,error:r}=await this._useSession((async t=>{var n,r,o,i,s;const{data:a,error:c}=t;if(c)throw c;const l=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(o=e.options)||void 0===o?void 0:o.queryParams,skipBrowserRedirect:!0});return await At(this.fetch,"GET",l,{headers:this.headers,jwt:null!==(s=null===(i=a.session)||void 0===i?void 0:i.access_token)&&void 0!==s?s:void 0})}));if(r)throw r;return ut()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==n?void 0:n.url),{data:{provider:e.provider,url:null==n?void 0:n.url},error:null}}catch(t){if(He(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var n,r;const{data:o,error:i}=t;if(i)throw i;return await At(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})}))}catch(e){if(He(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const o=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await At(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ot})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&et(t)&&Date.now()+n-o<Me},new Promise(((e,t)=>{(async()=>{for(let o=0;o<1/0;o++)try{const t=await n(o);if(!r(o,null))return void e(t)}catch(e){if(!r(o,e))return void t(e)}})()})))}catch(e){if(this._debug(t,"error",e),He(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),ut()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await mt(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const r=1e3*(null!==(e=n.expires_at)&&void 0!==e?e:1/0)-Date.now()<9e4;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),et(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(e){return this._debug(t,"error",e),void console.error(e)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Ke;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new vt;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new Ke;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(e){if(this._debug(r,"error",e),He(e)){const n={session:null,error:e};return et(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(n),n}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(e),e}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,n=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],o=Array.from(this.stateChangeEmitters.values()).map((async n=>{try{await n.callback(e,t)}catch(e){r.push(e)}}));if(await Promise.all(o),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ft(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await gt(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ut()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Me);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const e=Date.now();try{return await this._useSession((async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-e)/Me);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(n.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof jt))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ut()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=[`provider=${encodeURIComponent(t)}`];if((null==n?void 0:n.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),(null==n?void 0:n.scopes)&&r.push(`scopes=${encodeURIComponent(n.scopes)}`),"pkce"===this.flowType){const[e,t]=await _t(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(n.toString())}if(null==n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null==n?void 0:n.skipBrowserRedirect)&&r.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var n;const{data:r,error:o}=t;return o?{data:null,error:o}:await At(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(e){if(He(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession((async t=>{var n,r;const{data:o,error:i}=t;if(i)return{data:null,error:i};const s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:c}=await At(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:null===(n=null==o?void 0:o.session)||void 0===n?void 0:n.access_token});return c?{data:null,error:c}:("totp"===e.factorType&&(null===(r=null==a?void 0:a.totp)||void 0===r?void 0:r.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})}))}catch(e){if(He(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:o}=t;if(o)return{data:null,error:o};const{data:i,error:s}=await At(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:s})}))}catch(e){if(He(e))return{data:null,error:e};throw e}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:o}=t;return o?{data:null,error:o}:await At(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(e){if(He(e))return{data:null,error:e};throw e}}))}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null==e?void 0:e.factors)||[],r=n.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),o=n.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:n,totp:r,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,n;const{data:{session:r},error:o}=e;if(o)return{data:null,error:o};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=bt(r.access_token);let s=null;i.aal&&(s=i.aal);let a=s;return(null!==(n=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==n?n:[]).length>0&&(a="aal2"),{data:{currentLevel:s,nextLevel:a,currentAuthenticationMethods:i.amr||[]},error:null}}))))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find((t=>t.kid===e));if(n)return n;if(n=this.jwks.keys.find((t=>t.kid===e)),n&&this.jwks_cached_at+6e5>Date.now())return n;const{data:r,error:o}=await At(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;if(!r.keys||0===r.keys.length)throw new nt("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),n=r.keys.find((t=>t.kid===e)),!n)throw new nt("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};n=e.session.access_token}const{header:r,payload:o,signature:i,raw:{header:s,payload:a}}=bt(n);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(o.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:o,header:r,signature:i},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),l=await this.fetchJwk(r.kid,t),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,u,i,function(e){const t=[];return function(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}ct(r,t)}}(e,(e=>t.push(e))),new Uint8Array(t)}(`${s}.${a}`)))throw new nt("Invalid JWT signature");return{data:{claims:o,header:r,signature:i},error:null}}catch(e){if(He(e))return{data:null,error:e};throw e}}}Gt.nextInstanceID=0;const Vt=Gt;class Bt extends Vt{constructor(e){super(e)}}class Ht{constructor(e,t,n){var r,o,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const s=e.replace(/\/$/,"");this.realtimeUrl=`${s}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,this.functionsUrl=`${s}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c=function(e,t){const{db:n,auth:r,realtime:o,global:i}=e,{db:s,auth:a,realtime:c,global:l}=t,u={db:Object.assign(Object.assign({},s),n),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign({},l),i),accessToken:()=>{return e=this,t=void 0,r=function*(){return""},new((n=void 0)||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r}};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=n?n:{},{db:xe,realtime:Re,auth:Object.assign(Object.assign({},Ce),{storageKey:a}),global:Ie});this.storageKey=null!==(r=c.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(o=c.global.headers)&&void 0!==o?o:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=c.auth)&&void 0!==i?i:{},this.headers,c.global.fetch),this.fetch=Ue(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new T(`${s}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new S(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ke(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,n,r,o,i;return n=this,r=void 0,i=function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,a)}c((i=i.apply(n,r||[])).next())}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,storageKey:o,flowType:i,lock:s,debug:a},c,l){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bt({url:this.authUrl,headers:Object.assign(Object.assign({},u),c),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,flowType:i,lock:s,debug:a,fetch:l,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ie(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=n}}var zt=s(5606);function Wt(e){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(e)}function qt(){qt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,s=Object.create(i.prototype),a=new x(r||[]);return o(s,"_invoke",{value:O(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function v(){}function b(){}function y(){}var _={};l(_,s,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(C([])));S&&S!==n&&r.call(S,s)&&(_=S);var E=y.prototype=v.prototype=Object.create(_);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(o,i,s,a){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==Wt(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function O(t,n,r){var o=h;return function(i,s){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw s;return{value:e,done:!0}}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var c=k(a,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?m:p,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Wt(t)+" is not iterable")}return b.prototype=y,o(E,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:b,configurable:!0}),b.displayName=l(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(A.prototype),l(A.prototype,a,(function(){return this})),t.AsyncIterator=A,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var s=new A(u(e,n,r,o),i);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(E),l(E,c,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return a.type="throw",a.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function Kt(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function Jt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){Kt(i,r,o,s,a,"next",e)}function a(e){Kt(i,r,o,s,a,"throw",e)}s(void 0)}))}}var Yt=function(){var e=window.SUPABASE_URL||(void 0!==zt?{NVM_INC:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/include/node",TERM_PROGRAM:"vscode",NODE:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",INIT_CWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",NVM_CD_FLAGS:"-q",PYENV_ROOT:"/Users/renatoboemer/.pyenv",TERM:"xterm-256color",SHELL:"/bin/zsh",TMPDIR:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/",npm_config_global_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",TERM_PROGRAM_VERSION:"0.48.9",ZDOTDIR:"/Users/renatoboemer",CURSOR_TRACE_ID:"cdf90b5ac0d14854963123fad7ea0247",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/renatoboemer/code/developer/ai-shopping-shopify",PNPM_HOME:"/Users/renatoboemer/Library/pnpm",PYTHONBREAKPOINT:"ipdb.set_trace",LC_ALL:"en_US.UTF-8",NVM_DIR:"/Users/renatoboemer/.nvm",USER:"renatoboemer",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/etc/npmrc",HOMEBREW_NO_ANALYTICS:"1",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.HMAZGRSvi9/Listeners",PYENV_VIRTUALENV_DISABLE_PROMPT:"1",__CF_USER_TEXT_ENCODING:"0x1F5:0:2",npm_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/bin/npm-cli.js",PYENV_VIRTUALENV_INIT:"1",VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",PAGER:"less",PYENV_VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin:/Users/renatoboemer/code/developer/node_modules/.bin:/Users/renatoboemer/code/node_modules/.bin:/Users/renatoboemer/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.pyenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/Users/renatoboemer/Library/pnpm:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter",npm_package_json:"/Users/renatoboemer/code/developer/ai-shopping-shopify/package.json",_:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin/webpack",npm_config_userconfig:"/Users/renatoboemer/.npmrc",npm_config_init_module:"/Users/renatoboemer/.npm-init.js",USER_ZDOTDIR:"/Users/renatoboemer",__CFBundleIdentifier:"com.todesktop.230313mzl4w4u92",npm_command:"run-script",PWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",npm_lifecycle_event:"build",EDITOR:"code",npm_package_name:"ai-shopping-shopify",LANG:"en_US.UTF-8",npm_config_npm_version:"10.8.2",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_package_engines_node:"18.x || 20.x",npm_config_node_gyp:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",PYENV_SHELL:"zsh",SHLVL:"2",HOME:"/Users/renatoboemer",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",BUNDLER_EDITOR:"code",npm_config_cache:"/Users/renatoboemer/.npm",LESS:"-R",LOGNAME:"renatoboemer",npm_lifecycle_script:"webpack --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/vscode-git-19ee989870.sock",NVM_BIN:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin",npm_config_user_agent:"npm/10.8.2 node/v20.18.3 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Cursor.app/Contents/Frameworks/Cursor Helper (Plugin).app/Contents/MacOS/Cursor Helper (Plugin)",GIT_ASKPASS:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass.sh",npm_node_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",npm_config_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",COLORTERM:"truecolor"}.SUPABASE_URL:"")||"",t=window.SUPABASE_KEY||(void 0!==zt?{NVM_INC:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/include/node",TERM_PROGRAM:"vscode",NODE:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",INIT_CWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",NVM_CD_FLAGS:"-q",PYENV_ROOT:"/Users/renatoboemer/.pyenv",TERM:"xterm-256color",SHELL:"/bin/zsh",TMPDIR:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/",npm_config_global_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",TERM_PROGRAM_VERSION:"0.48.9",ZDOTDIR:"/Users/renatoboemer",CURSOR_TRACE_ID:"cdf90b5ac0d14854963123fad7ea0247",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/renatoboemer/code/developer/ai-shopping-shopify",PNPM_HOME:"/Users/renatoboemer/Library/pnpm",PYTHONBREAKPOINT:"ipdb.set_trace",LC_ALL:"en_US.UTF-8",NVM_DIR:"/Users/renatoboemer/.nvm",USER:"renatoboemer",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/etc/npmrc",HOMEBREW_NO_ANALYTICS:"1",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.HMAZGRSvi9/Listeners",PYENV_VIRTUALENV_DISABLE_PROMPT:"1",__CF_USER_TEXT_ENCODING:"0x1F5:0:2",npm_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/bin/npm-cli.js",PYENV_VIRTUALENV_INIT:"1",VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",PAGER:"less",PYENV_VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin:/Users/renatoboemer/code/developer/node_modules/.bin:/Users/renatoboemer/code/node_modules/.bin:/Users/renatoboemer/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.pyenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/Users/renatoboemer/Library/pnpm:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter",npm_package_json:"/Users/renatoboemer/code/developer/ai-shopping-shopify/package.json",_:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin/webpack",npm_config_userconfig:"/Users/renatoboemer/.npmrc",npm_config_init_module:"/Users/renatoboemer/.npm-init.js",USER_ZDOTDIR:"/Users/renatoboemer",__CFBundleIdentifier:"com.todesktop.230313mzl4w4u92",npm_command:"run-script",PWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",npm_lifecycle_event:"build",EDITOR:"code",npm_package_name:"ai-shopping-shopify",LANG:"en_US.UTF-8",npm_config_npm_version:"10.8.2",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_package_engines_node:"18.x || 20.x",npm_config_node_gyp:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",PYENV_SHELL:"zsh",SHLVL:"2",HOME:"/Users/renatoboemer",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",BUNDLER_EDITOR:"code",npm_config_cache:"/Users/renatoboemer/.npm",LESS:"-R",LOGNAME:"renatoboemer",npm_lifecycle_script:"webpack --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/vscode-git-19ee989870.sock",NVM_BIN:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin",npm_config_user_agent:"npm/10.8.2 node/v20.18.3 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Cursor.app/Contents/Frameworks/Cursor Helper (Plugin).app/Contents/MacOS/Cursor Helper (Plugin)",GIT_ASKPASS:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass.sh",npm_node_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",npm_config_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",COLORTERM:"truecolor"}.SUPABASE_KEY:"")||"";return e&&t?((e,t)=>new Ht(e,t,void 0))(e,t):(console.error("Missing Supabase credentials"),null)},Xt=function(){var e=Jt(qt().mark((function e(t){var n,r,o,i,s,a,c=arguments;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:null,r=Yt()){e.next=4;break}return e.abrupt("return",{error:"Supabase client not available"});case 4:return o={shop_id:t,customer_id:n},e.prev=5,e.next=8,r.from("conversations").insert([o]).select().single();case 8:if(i=e.sent,s=i.data,!(a=i.error)){e.next=13;break}throw a;case 13:return e.abrupt("return",{conversation:s});case 16:return e.prev=16,e.t0=e.catch(5),console.error("Error creating conversation:",e.t0),e.abrupt("return",{error:e.t0.message});case 20:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t){return e.apply(this,arguments)}}(),Zt=function(){var e=Jt(qt().mark((function e(t,n,r){var o,i,s,a,c;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Yt()){e.next=3;break}return e.abrupt("return",{error:"Supabase client not available"});case 3:return i={conversation_id:t,role:n,content:r},e.prev=4,e.next=7,o.from("messages").insert([i]).select().single();case 7:if(s=e.sent,a=s.data,!(c=s.error)){e.next=12;break}throw c;case 12:return e.next=14,o.from("conversations").update({last_message_at:(new Date).toISOString()}).eq("id",t);case 14:return e.abrupt("return",{message:a});case 17:return e.prev=17,e.t0=e.catch(4),console.error("Error adding message:",e.t0),e.abrupt("return",{error:e.t0.message});case 21:case"end":return e.stop()}}),e,null,[[4,17]])})));return function(t,n,r){return e.apply(this,arguments)}}(),Qt=function(){var e=Jt(qt().mark((function e(t){var n,r,o,i,s,a=arguments;return qt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:50,r=Yt()){e.next=4;break}return e.abrupt("return",{error:"Supabase client not available"});case 4:return e.prev=4,e.next=7,r.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0}).limit(n);case 7:if(o=e.sent,i=o.data,!(s=o.error)){e.next=12;break}throw s;case 12:return e.abrupt("return",{messages:i});case 15:return e.prev=15,e.t0=e.catch(4),console.error("Error getting messages:",e.t0),e.abrupt("return",{error:e.t0.message});case 19:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t){return e.apply(this,arguments)}}();function en(e){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},en(e)}function tn(e){return function(e){if(Array.isArray(e))return nn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return nn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function rn(){rn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,s=Object.create(i.prototype),a=new x(r||[]);return o(s,"_invoke",{value:O(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function v(){}function b(){}function y(){}var _={};l(_,s,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(C([])));S&&S!==n&&r.call(S,s)&&(_=S);var E=y.prototype=v.prototype=Object.create(_);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(o,i,s,a){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==en(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function O(t,n,r){var o=h;return function(i,s){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw s;return{value:e,done:!0}}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var c=k(a,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?m:p,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(en(t)+" is not iterable")}return b.prototype=y,o(E,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:b,configurable:!0}),b.displayName=l(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(A.prototype),l(A.prototype,a,(function(){return this})),t.AsyncIterator=A,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var s=new A(u(e,n,r,o),i);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(E),l(E,c,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return a.type="throw",a.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function on(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function sn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){on(i,r,o,s,a,"next",e)}function a(e){on(i,r,o,s,a,"throw",e)}s(void 0)}))}}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,cn(r.key),r)}}function cn(e){var t=function(e){if("object"!=en(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=en(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==en(t)?t:t+""}var ln=function(){if(console.log("Initializing chat widget..."),"loading"===document.readyState)return console.log("Document still loading, deferring chat widget initialization"),null;var e=new un;return setTimeout((function(){e.init()}),100),console.log("Chat widget initialized"),e},un=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=null,this.messagesContainer=null,this.inputField=null,this.sendButton=null,this.toggleButton=null,this.isMinimized=!1,this.isLoading=!1,this.conversationHistory=[],this.initialized=!1,this.conversationId=null,this.shopId=this.getShopId(),this.customerId=this.getCustomerId(),console.log("ChatWidget constructed")},t=[{key:"getShopId",value:function(){return new URL(window.location.href).searchParams.get("shop")||(window.SHOPIFY_STORE_URL?window.SHOPIFY_STORE_URL:window.location.ancestorOrigins&&window.location.ancestorOrigins[0]?new URL(window.location.ancestorOrigins[0]).hostname:{NVM_INC:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/include/node",TERM_PROGRAM:"vscode",NODE:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",INIT_CWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",NVM_CD_FLAGS:"-q",PYENV_ROOT:"/Users/renatoboemer/.pyenv",TERM:"xterm-256color",SHELL:"/bin/zsh",TMPDIR:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/",npm_config_global_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",TERM_PROGRAM_VERSION:"0.48.9",ZDOTDIR:"/Users/renatoboemer",CURSOR_TRACE_ID:"cdf90b5ac0d14854963123fad7ea0247",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/renatoboemer/code/developer/ai-shopping-shopify",PNPM_HOME:"/Users/renatoboemer/Library/pnpm",PYTHONBREAKPOINT:"ipdb.set_trace",LC_ALL:"en_US.UTF-8",NVM_DIR:"/Users/renatoboemer/.nvm",USER:"renatoboemer",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/etc/npmrc",HOMEBREW_NO_ANALYTICS:"1",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.HMAZGRSvi9/Listeners",PYENV_VIRTUALENV_DISABLE_PROMPT:"1",__CF_USER_TEXT_ENCODING:"0x1F5:0:2",npm_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/bin/npm-cli.js",PYENV_VIRTUALENV_INIT:"1",VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",PAGER:"less",PYENV_VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin:/Users/renatoboemer/code/developer/node_modules/.bin:/Users/renatoboemer/code/node_modules/.bin:/Users/renatoboemer/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.pyenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/Users/renatoboemer/Library/pnpm:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter",npm_package_json:"/Users/renatoboemer/code/developer/ai-shopping-shopify/package.json",_:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin/webpack",npm_config_userconfig:"/Users/renatoboemer/.npmrc",npm_config_init_module:"/Users/renatoboemer/.npm-init.js",USER_ZDOTDIR:"/Users/renatoboemer",__CFBundleIdentifier:"com.todesktop.230313mzl4w4u92",npm_command:"run-script",PWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",npm_lifecycle_event:"build",EDITOR:"code",npm_package_name:"ai-shopping-shopify",LANG:"en_US.UTF-8",npm_config_npm_version:"10.8.2",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_package_engines_node:"18.x || 20.x",npm_config_node_gyp:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",PYENV_SHELL:"zsh",SHLVL:"2",HOME:"/Users/renatoboemer",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",BUNDLER_EDITOR:"code",npm_config_cache:"/Users/renatoboemer/.npm",LESS:"-R",LOGNAME:"renatoboemer",npm_lifecycle_script:"webpack --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/vscode-git-19ee989870.sock",NVM_BIN:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin",npm_config_user_agent:"npm/10.8.2 node/v20.18.3 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Cursor.app/Contents/Frameworks/Cursor Helper (Plugin).app/Contents/MacOS/Cursor Helper (Plugin)",GIT_ASKPASS:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass.sh",npm_node_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",npm_config_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",COLORTERM:"truecolor"}.SHOPIFY_STORE_URL||"test-store-tailor-ai.myshopify.com")}},{key:"getCustomerId",value:function(){return null}},{key:"init",value:(s=sn(rn().mark((function e(){var t,n,r,o;return rn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.initialized){e.next=4;break}return console.log("ChatWidget already initialized, skipping"),e.abrupt("return");case 4:if(console.log("Starting ChatWidget.init()"),this.container=document.getElementById("ai-shopping-assistant"),console.log("Container found:",!!this.container),this.container||(console.log("Creating container as it does not exist"),this.container=this.createChatContainer(),document.body.appendChild(this.container),console.log("Container created and appended to body")),this.container.querySelector(".chat-messages")&&this.container.querySelector('input[type="text"]')&&this.container.querySelector("button:not(.toggle-button)")&&this.container.querySelector(".toggle-button")||(console.log("Container exists but missing required elements, adding chat interface"),t=this.container.innerHTML,this.container.innerHTML='\n          <div class="chat-widget-header">\n            <h3>Shopping Assistant</h3>\n            <button id="toggle-chat" class="toggle-button">-</button>\n          </div>\n          <div class="chat-messages" id="chat-messages">\n            '.concat(t,'\n          </div>\n          <div class="chat-input-container">\n            <input type="text" id="chat-input" placeholder="Ask about products...">\n            <button id="send-message">Send</button>\n          </div>\n        ')),this.messagesContainer=this.container.querySelector(".chat-messages"),this.inputField=this.container.querySelector('input[type="text"]'),this.sendButton=this.container.querySelector("button:not(.toggle-button)"),this.toggleButton=this.container.querySelector(".toggle-button"),console.log("Elements found:","messagesContainer:",!!this.messagesContainer,"inputField:",!!this.inputField,"sendButton:",!!this.sendButton,"toggleButton:",!!this.toggleButton),this.messagesContainer&&this.inputField&&this.sendButton&&this.toggleButton){e.next=18;break}return console.error("ChatWidget initialization failed - critical elements not found"),e.abrupt("return");case 18:if((n=this.messagesContainer.querySelectorAll(".message:not(.loading)")).length>0&&(console.log("Found ".concat(n.length," existing messages, clearing them to prevent duplicates")),n.forEach((function(e){return e.remove()}))),this.restoreConversationFromStorage()){e.next=29;break}return e.next=24,this.createNewConversation();case 24:return e.next=26,this.loadMessages();case 26:r=this.conversationHistory.length>0,o=null!==this.messagesContainer.querySelector(".assistant-message"),r||o||!this.messagesContainer?console.log("Skipping welcome message, conversation already has messages"):(console.log("No messages found, adding welcome message"),this.addWelcomeMessageDirect());case 29:this.setupEventListeners(),this.initialized=!0,console.log("ChatWidget initialization completed"),e.next=37;break;case 34:e.prev=34,e.t0=e.catch(0),console.error("Error in ChatWidget.init():",e.t0);case 37:case"end":return e.stop()}}),e,this,[[0,34]])}))),function(){return s.apply(this,arguments)})},{key:"createNewConversation",value:(i=sn(rn().mark((function e(){var t,n,r;return rn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.shopId||(console.warn("Shop ID not available, using default"),this.shopId="default-shop"),console.log("Creating new conversation with shop ID:",this.shopId),e.next=5,Xt(this.shopId,this.customerId);case 5:if(t=e.sent,n=t.conversation,!(r=t.error)){e.next=11;break}return console.error("Error creating conversation:",r),e.abrupt("return");case 11:n&&(this.conversationId=n.id,console.log("New conversation created with ID:",this.conversationId)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Error in createNewConversation:",e.t0);case 17:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(){return i.apply(this,arguments)})},{key:"loadMessages",value:(o=sn(rn().mark((function e(){var t,n,r,o=this;return rn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.conversationId){e.next=4;break}return console.warn("No conversation ID available, skipping message loading"),e.abrupt("return");case 4:return console.log("Loading messages for conversation:",this.conversationId),e.next=7,Qt(this.conversationId);case 7:if(t=e.sent,n=t.messages,!(r=t.error)){e.next=13;break}return console.error("Error loading messages:",r),e.abrupt("return");case 13:n&&n.length>0?(console.log("Loaded ".concat(n.length," messages from Supabase")),this.messagesContainer.innerHTML="",this.conversationHistory=[],n.forEach((function(e){o.conversationHistory.push({role:e.role,content:e.content}),"user"===e.role?o.addUserMessageDirect(e.content):"assistant"===e.role&&o.addAssistantMessageDirect(e.content)})),console.log("Messages loaded and displayed")):console.log("No previous messages found"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Error in loadMessages:",e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(){return o.apply(this,arguments)})},{key:"createChatContainer",value:function(){var e=document.createElement("div");return e.id="ai-shopping-assistant",e.className="chat-widget-container",e.innerHTML='\n      <div class="chat-widget-header">\n        <h3>Shopping Assistant</h3>\n        <button id="toggle-chat" class="toggle-button">-</button>\n      </div>\n      <div class="chat-messages" id="chat-messages">\n        \x3c!-- Messages will be displayed here --\x3e\n      </div>\n      <div class="chat-input-container">\n        <input type="text" id="chat-input" placeholder="Ask about products...">\n        <button id="send-message">Send</button>\n      </div>\n    ',e}},{key:"setupEventListeners",value:function(){var e=this;try{if(!this.sendButton||!this.inputField||!this.toggleButton)return void console.error("Cannot set up event listeners - UI elements not found:",{sendButton:!this.sendButton,inputField:!this.inputField,toggleButton:!this.toggleButton});try{this.sendButton.addEventListener("click",(function(){e.handleSendMessage()})),console.log("Added click listener to send button")}catch(e){console.error("Error adding click listener to send button:",e)}try{this.inputField.addEventListener("keypress",(function(t){"Enter"===t.key&&(t.preventDefault(),e.handleSendMessage())})),console.log("Added keypress listener to input field")}catch(e){console.error("Error adding keypress listener to input field:",e)}try{this.toggleButton.addEventListener("click",(function(){e.toggleChat()})),console.log("Added click listener to toggle button")}catch(e){console.error("Error adding click listener to toggle button:",e)}console.log("Event listeners successfully set up")}catch(e){console.error("Error in setupEventListeners:",e)}}},{key:"addWelcomeMessageDirect",value:function(){if(console.log("Adding welcome message directly"),this.messagesContainer)if(this.messagesContainer.querySelectorAll(".assistant-message").length>0)console.log("Welcome message already exists, skipping to prevent duplicates");else{var e=new Date,t=e.getDate().toString().padStart(2,"0"),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],r=e.getFullYear(),o=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0"),s="".concat(t," ").concat(n," ").concat(r,", ").concat(o,":").concat(i),a=document.createElement("div");a.className="message assistant-message",a.innerHTML='\n      <div class="message-content">\n        <p>Hello! I\'m your shopping assistant. How can I help you today?</p>\n      </div>\n      <div class="message-time">'.concat(s,"</div>\n    "),this.messagesContainer.appendChild(a),console.log("Welcome message element added to container"),this.conversationHistory.push({role:"assistant",content:"Hello! I'm your shopping assistant. How can I help you today?"}),this.saveMessageToSupabase("assistant","Hello! I'm your shopping assistant. How can I help you today?"),this.saveConversationToStorage()}else console.error("messagesContainer is null - cannot add welcome message")}},{key:"saveMessageToSupabase",value:(r=sn(rn().mark((function e(t,n){var r,o,i;return rn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.conversationId){e.next=4;break}return console.warn("No conversation ID available, cannot save message"),e.abrupt("return");case 4:return console.log("Saving ".concat(t," message to Supabase:"),n.substring(0,30)+"..."),e.next=7,Zt(this.conversationId,t,n);case 7:if(r=e.sent,o=r.message,!(i=r.error)){e.next=13;break}return console.error("Error saving message to Supabase:",i),e.abrupt("return");case 13:console.log("Message saved successfully with ID:",null==o?void 0:o.id),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error("Error in saveMessageToSupabase:",e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(e,t){return r.apply(this,arguments)})},{key:"handleSendMessage",value:(n=sn(rn().mark((function e(){var t,n,r,o,i,s;return rn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.inputField.value.trim())&&!this.isLoading){e.next=3;break}return e.abrupt("return");case 3:return this.inputField.value="",console.log("Handling send message:",t),this.addUserMessageDirect(t),this.conversationHistory.push({role:"user",content:t}),e.next=9,this.saveMessageToSupabase("user",t);case 9:return this.saveConversationToStorage(),this.setLoading(!0),e.prev=11,n={model:"claude-3-7-sonnet-20250219",max_tokens:1024,messages:tn(this.conversationHistory)},console.log("Sending request to Claude API with body:",JSON.stringify(n)),e.next=16,fetch("/api/claude",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 16:return r=e.sent,console.log("Claude API response status:",r.status),e.next=20,r.text();case 20:o=e.sent,console.log("Claude API raw response:",o),e.prev=22,i=JSON.parse(o),e.next=30;break;case 26:throw e.prev=26,e.t0=e.catch(22),console.error("Failed to parse JSON response:",e.t0),new Error("Invalid JSON response from server");case 30:if(r.ok){e.next=33;break}throw console.error("Error response from API:",i),new Error("API responded with status ".concat(r.status,": ").concat(JSON.stringify(i)));case 33:if(console.log("Parsed Claude API response:",i),i.content&&i.content[0]&&i.content[0].text){e.next=37;break}throw console.error("Unexpected response format:",i),new Error("Invalid response format from API");case 37:return s=i.content[0].text,console.log("Assistant response:",s),this.conversationHistory.push({role:"assistant",content:s}),e.next=42,this.saveMessageToSupabase("assistant",s);case 42:this.addAssistantMessageDirect(s),this.saveConversationToStorage(),e.next=53;break;case 46:return e.prev=46,e.t1=e.catch(11),console.error("Error processing message:",e.t1),this.addAssistantMessageDirect("Sorry, I encountered an error. Please try again later. Technical details: "+e.t1.message),e.next=52,this.saveMessageToSupabase("assistant","Sorry, I encountered an error. Please try again later. Technical details: "+e.t1.message);case 52:this.saveConversationToStorage();case 53:return e.prev=53,this.setLoading(!1),e.finish(53);case 56:case"end":return e.stop()}}),e,this,[[11,46,53,56],[22,26]])}))),function(){return n.apply(this,arguments)})},{key:"addUserMessageDirect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];console.log("Adding user message directly:",e);var n=new Date,r=n.getDate().toString().padStart(2,"0"),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()],i=n.getFullYear(),s=n.getHours().toString().padStart(2,"0"),a=n.getMinutes().toString().padStart(2,"0"),c="".concat(r," ").concat(o," ").concat(i,", ").concat(s,":").concat(a),l=document.createElement("div");l.className="message user-message";var u=this.escapeHtml(e);l.innerHTML='\n      <div class="message-content">\n        <p>'.concat(u,'</p>\n      </div>\n      <div class="message-time">').concat(c,"</div>\n    "),this.messagesContainer.appendChild(l),t&&this.scrollToBottom()}},{key:"addAssistantMessageDirect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];console.log("Adding assistant message directly:",e);var n=new Date,r=n.getDate().toString().padStart(2,"0"),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()],i=n.getFullYear(),s=n.getHours().toString().padStart(2,"0"),a=n.getMinutes().toString().padStart(2,"0"),c="".concat(r," ").concat(o," ").concat(i,", ").concat(s,":").concat(a),l=document.createElement("div");l.className="message assistant-message";var u=this.formatMessageText(e);l.innerHTML='\n      <div class="message-content">\n        <p>'.concat(u,'</p>\n      </div>\n      <div class="message-time">').concat(c,"</div>\n    "),this.messagesContainer.appendChild(l),t&&this.scrollToBottom()}},{key:"setLoading",value:function(e){if(this.isLoading=e,e){var t=document.createElement("div");t.className="message assistant-message loading",t.innerHTML='<div class="loading-indicator"><span></span><span></span><span></span></div>',t.id="loading-message",this.messagesContainer.appendChild(t),this.scrollToBottom()}else{var n=document.getElementById("loading-message");n&&n.remove()}}},{key:"scrollToBottom",value:function(){this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}},{key:"formatMessageText",value:function(e){if(!e)return"";var t=this.escapeHtml(e);return(t=t.replace(/\[(.*?)\]\((https?:\/\/.*?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>')).replace(/\n/g,"<br>")}},{key:"escapeHtml",value:function(e){if(!e)return"";var t=document.createElement("div");return t.textContent=e,t.innerHTML}},{key:"toggleChat",value:function(){this.isMinimized=!this.isMinimized,this.isMinimized?(this.container.classList.add("minimized"),this.toggleButton.textContent="+"):(this.container.classList.remove("minimized"),this.toggleButton.textContent="-")}},{key:"saveConversationToStorage",value:function(){try{if(!this.conversationId)return;var e={conversationId:this.conversationId,shopId:this.shopId,customerId:this.customerId,conversationHistory:this.conversationHistory,timestamp:(new Date).getTime()};localStorage.setItem("aiShoppingAssistant_conversation",JSON.stringify(e)),console.log("Conversation saved to localStorage")}catch(e){console.error("Error saving conversation to localStorage:",e)}}},{key:"restoreConversationFromStorage",value:function(){try{var e=localStorage.getItem("aiShoppingAssistant_conversation");if(!e)return console.log("No stored conversation found"),!1;var t=JSON.parse(e);return((new Date).getTime()-(t.timestamp||0))/36e5>24?(console.log("Stored conversation is too old (>24 hours), starting a new one"),localStorage.removeItem("aiShoppingAssistant_conversation"),!1):(this.conversationId=t.conversationId,this.conversationHistory=t.conversationHistory||[],this.displayConversationHistory(),console.log("Conversation restored from localStorage:",this.conversationId,"(".concat(this.conversationHistory.length," messages)")),!0)}catch(e){return console.error("Error restoring conversation from localStorage:",e),!1}}},{key:"displayConversationHistory",value:function(){var e=this;this.messagesContainer&&this.conversationHistory&&0!==this.conversationHistory.length&&(this.messagesContainer.innerHTML="",this.conversationHistory.forEach((function(t){"user"===t.role?e.addUserMessageDirect(t.content,!1):"assistant"===t.role&&e.addAssistantMessageDirect(t.content,!1)})),setTimeout((function(){return e.scrollToBottom()}),100))}}],t&&an(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,s}(),dn=s(5824),hn=s(5606);function pn(e){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(e)}function fn(){fn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,s=Object.create(i.prototype),a=new x(r||[]);return o(s,"_invoke",{value:O(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",m="completed",g={};function v(){}function b(){}function y(){}var _={};l(_,s,(function(){return this}));var w=Object.getPrototypeOf,S=w&&w(w(C([])));S&&S!==n&&r.call(S,s)&&(_=S);var E=y.prototype=v.prototype=Object.create(_);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(o,i,s,a){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==pn(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function O(t,n,r){var o=h;return function(i,s){if(o===f)throw Error("Generator is already running");if(o===m){if("throw"===i)throw s;return{value:e,done:!0}}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var c=k(a,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?m:p,l.arg===g)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=m,r.method="throw",r.arg=l.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(pn(t)+" is not iterable")}return b.prototype=y,o(E,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:b,configurable:!0}),b.displayName=l(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},T(A.prototype),l(A.prototype,a,(function(){return this})),t.AsyncIterator=A,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var s=new A(u(e,n,r,o),i);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(E),l(E,c,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return a.type="throw",a.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function mn(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}var gn=function(){var e,t=(e=fn().mark((function e(){var t,n,r,o,i,s;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.CLAUDE_API_KEY||(void 0!==hn?{NVM_INC:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/include/node",TERM_PROGRAM:"vscode",NODE:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",INIT_CWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",NVM_CD_FLAGS:"-q",PYENV_ROOT:"/Users/renatoboemer/.pyenv",TERM:"xterm-256color",SHELL:"/bin/zsh",TMPDIR:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/",npm_config_global_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",TERM_PROGRAM_VERSION:"0.48.9",ZDOTDIR:"/Users/renatoboemer",CURSOR_TRACE_ID:"cdf90b5ac0d14854963123fad7ea0247",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/renatoboemer/code/developer/ai-shopping-shopify",PNPM_HOME:"/Users/renatoboemer/Library/pnpm",PYTHONBREAKPOINT:"ipdb.set_trace",LC_ALL:"en_US.UTF-8",NVM_DIR:"/Users/renatoboemer/.nvm",USER:"renatoboemer",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/etc/npmrc",HOMEBREW_NO_ANALYTICS:"1",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.HMAZGRSvi9/Listeners",PYENV_VIRTUALENV_DISABLE_PROMPT:"1",__CF_USER_TEXT_ENCODING:"0x1F5:0:2",npm_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/bin/npm-cli.js",PYENV_VIRTUALENV_INIT:"1",VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",PAGER:"less",PYENV_VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin:/Users/renatoboemer/code/developer/node_modules/.bin:/Users/renatoboemer/code/node_modules/.bin:/Users/renatoboemer/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.pyenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/Users/renatoboemer/Library/pnpm:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter",npm_package_json:"/Users/renatoboemer/code/developer/ai-shopping-shopify/package.json",_:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin/webpack",npm_config_userconfig:"/Users/renatoboemer/.npmrc",npm_config_init_module:"/Users/renatoboemer/.npm-init.js",USER_ZDOTDIR:"/Users/renatoboemer",__CFBundleIdentifier:"com.todesktop.230313mzl4w4u92",npm_command:"run-script",PWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",npm_lifecycle_event:"build",EDITOR:"code",npm_package_name:"ai-shopping-shopify",LANG:"en_US.UTF-8",npm_config_npm_version:"10.8.2",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_package_engines_node:"18.x || 20.x",npm_config_node_gyp:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",PYENV_SHELL:"zsh",SHLVL:"2",HOME:"/Users/renatoboemer",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",BUNDLER_EDITOR:"code",npm_config_cache:"/Users/renatoboemer/.npm",LESS:"-R",LOGNAME:"renatoboemer",npm_lifecycle_script:"webpack --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/vscode-git-19ee989870.sock",NVM_BIN:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin",npm_config_user_agent:"npm/10.8.2 node/v20.18.3 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Cursor.app/Contents/Frameworks/Cursor Helper (Plugin).app/Contents/MacOS/Cursor Helper (Plugin)",GIT_ASKPASS:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass.sh",npm_node_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",npm_config_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",COLORTERM:"truecolor"}.CLAUDE_API_KEY:"")||""){e.next=4;break}return console.error("Missing Claude API key for test"),e.abrupt("return",{error:"Claude API key is missing"});case 4:return e.prev=4,console.log("Testing Claude API connection..."),console.log("API Key starts with:",t.substring(0,4)+"..."),n="/api/claude",console.log("Using API endpoint:",n),e.next=11,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":t},body:JSON.stringify({model:"claude-3-7-sonnet-20250219",max_tokens:100,messages:[{role:"user",content:"Hello, are you working?"}]})});case 11:if(r=e.sent,console.log("Claude API test response status:",r.status),r.ok){e.next=19;break}return e.next=16,r.json().catch((function(e){return{error:"Failed to parse error response"}}));case 16:return i=e.sent,console.error("Claude API test error details:",i),e.abrupt("return",{error:(null===(o=i.error)||void 0===o?void 0:o.message)||"API returned status ".concat(r.status)});case 19:return e.next=21,r.json();case 21:return s=e.sent,e.abrupt("return",{success:!0,message:s.content[0].text});case 25:return e.prev=25,e.t0=e.catch(4),console.error("Error in Claude API test:",e.t0),e.abrupt("return",{error:e.t0.message||"Unknown error occurred"});case 29:case"end":return e.stop()}}),e,null,[[4,25]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){mn(i,r,o,s,a,"next",e)}function a(e){mn(i,r,o,s,a,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}(),vn=!1,bn=function(){var e=window.location.href,t=new URLSearchParams(window.location.search);return e.includes("myshopify.com")||t.has("shop")||window.Shopify&&window.Shopify.shop},yn=function(){if(!window.SHOPIFY_STORE_URL){var e=new URL(window.location.href).searchParams.get("shop");e?window.SHOPIFY_STORE_URL=e:window.Shopify&&window.Shopify.shop?window.SHOPIFY_STORE_URL=window.Shopify.shop:window.location.host.includes("myshopify.com")&&(window.SHOPIFY_STORE_URL=window.location.host),console.log("Set SHOPIFY_STORE_URL:",window.SHOPIFY_STORE_URL)}},_n=function(){var e=document.getElementById("ai-shopping-assistant");return e||(console.log("Creating chat container"),(e=document.createElement("div")).id="ai-shopping-assistant",e.className="chat-widget-container",e.innerHTML='\n      <div class="chat-widget-header">\n        <h3>Shopping Assistant</h3>\n        <button id="toggle-chat" class="toggle-button">-</button>\n      </div>\n      <div class="chat-messages" id="chat-messages">\n        <div class="loading-indicator">\n          <span></span>\n          <span></span>\n          <span></span>\n        </div>\n      </div>\n      <div class="chat-input-container">\n        <input type="text" id="chat-input" placeholder="Ask about products...">\n        <button id="send-message">Send</button>\n      </div>\n    ',document.body.appendChild(e)),e};console.log("index.js loaded");var wn=!1,Sn=function(){if(wn||window.aiShopAssistant)console.log("Application already initialized, skipping");else{console.log("AI Shopping application initialization started"),wn=!0;try{var e=!!document.getElementById("shopify-app-bridge"),t=window.location.href.includes("myshopify.com")||new URLSearchParams(window.location.search).has("shop")||window.Shopify&&window.Shopify.shop;if(console.log("Running in",e?"Shopify admin mode":t?"Shopify storefront mode":"standalone mode"),e)try{!function(){try{if(!(window.top!==window.self&&window.location.ancestorOrigins&&window.location.ancestorOrigins[0]&&window.location.ancestorOrigins[0].includes("myshopify.com")))return console.log("Not in Shopify admin, skipping App Bridge initialization"),null;var e={NVM_INC:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/include/node",TERM_PROGRAM:"vscode",NODE:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",INIT_CWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",NVM_CD_FLAGS:"-q",PYENV_ROOT:"/Users/renatoboemer/.pyenv",TERM:"xterm-256color",SHELL:"/bin/zsh",TMPDIR:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/",npm_config_global_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",TERM_PROGRAM_VERSION:"0.48.9",ZDOTDIR:"/Users/renatoboemer",CURSOR_TRACE_ID:"cdf90b5ac0d14854963123fad7ea0247",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",MallocNanoZone:"0",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/renatoboemer/code/developer/ai-shopping-shopify",PNPM_HOME:"/Users/renatoboemer/Library/pnpm",PYTHONBREAKPOINT:"ipdb.set_trace",LC_ALL:"en_US.UTF-8",NVM_DIR:"/Users/renatoboemer/.nvm",USER:"renatoboemer",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/etc/npmrc",HOMEBREW_NO_ANALYTICS:"1",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.HMAZGRSvi9/Listeners",PYENV_VIRTUALENV_DISABLE_PROMPT:"1",__CF_USER_TEXT_ENCODING:"0x1F5:0:2",npm_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/bin/npm-cli.js",PYENV_VIRTUALENV_INIT:"1",VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",PAGER:"less",PYENV_VIRTUAL_ENV:"/Users/renatoboemer/.pyenv/versions/3.10.6/envs/lewagon",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin:/Users/renatoboemer/code/developer/node_modules/.bin:/Users/renatoboemer/code/node_modules/.bin:/Users/renatoboemer/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.pyenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/Users/renatoboemer/Library/pnpm:/Users/renatoboemer/.codeium/windsurf/bin:/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin:/Users/renatoboemer/.pyenv/plugins/pyenv-virtualenv/shims:/Users/renatoboemer/.rbenv/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/renatoboemer/.pyenv/bin:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter:./bin:./node_modules/.bin:/usr/local/sbin:/usr/local/bin/flutter",npm_package_json:"/Users/renatoboemer/code/developer/ai-shopping-shopify/package.json",_:"/Users/renatoboemer/code/developer/ai-shopping-shopify/node_modules/.bin/webpack",npm_config_userconfig:"/Users/renatoboemer/.npmrc",npm_config_init_module:"/Users/renatoboemer/.npm-init.js",USER_ZDOTDIR:"/Users/renatoboemer",__CFBundleIdentifier:"com.todesktop.230313mzl4w4u92",npm_command:"run-script",PWD:"/Users/renatoboemer/code/developer/ai-shopping-shopify",npm_lifecycle_event:"build",EDITOR:"code",npm_package_name:"ai-shopping-shopify",LANG:"en_US.UTF-8",npm_config_npm_version:"10.8.2",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",XPC_FLAGS:"0x0",npm_package_engines_node:"18.x || 20.x",npm_config_node_gyp:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"1.0.0",XPC_SERVICE_NAME:"0",VSCODE_INJECTION:"1",PYENV_SHELL:"zsh",SHLVL:"2",HOME:"/Users/renatoboemer",VSCODE_GIT_ASKPASS_MAIN:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",BUNDLER_EDITOR:"code",npm_config_cache:"/Users/renatoboemer/.npm",LESS:"-R",LOGNAME:"renatoboemer",npm_lifecycle_script:"webpack --mode production",VSCODE_GIT_IPC_HANDLE:"/var/folders/ph/zb4kk69x7sb77k_kwhx4fvm80000gn/T/vscode-git-19ee989870.sock",NVM_BIN:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin",npm_config_user_agent:"npm/10.8.2 node/v20.18.3 darwin arm64 workspaces/false",VSCODE_GIT_ASKPASS_NODE:"/Applications/Cursor.app/Contents/Frameworks/Cursor Helper (Plugin).app/Contents/MacOS/Cursor Helper (Plugin)",GIT_ASKPASS:"/Applications/Cursor.app/Contents/Resources/app/extensions/git/dist/askpass.sh",npm_node_execpath:"/Users/renatoboemer/.nvm/versions/node/v20.18.3/bin/node",npm_config_prefix:"/Users/renatoboemer/.nvm/versions/node/v20.18.3",COLORTERM:"truecolor"}.SHOPIFY_API_KEY||"";if(!e)return console.error("Missing Shopify API key"),null;var t={apiKey:e,host:new URL(window.location.href).searchParams.get("shop")||(window.location.ancestorOrigins&&window.location.ancestorOrigins[0]?new URL(window.location.ancestorOrigins[0]).hostname:""),forceRedirect:!1},n=(0,dn.createApp)(t);return console.log("App Bridge initialized successfully"),n}catch(e){return console.error("Failed to initialize App Bridge:",e),null}}(),console.log("App Bridge initialized")}catch(e){console.error("Failed to initialize App Bridge:",e)}else if(t)try{!function(){if(console.log("Initializing Shopify app embed"),vn||window.aiShopAssistant)return console.log("Shopify app embed already initialized, returning existing instance"),window.aiShopAssistant;try{vn=!0;var e=bn();console.log("Is in Shopify storefront:",e),yn(),_n();var t=ln();return window.aiShopAssistant=t,console.log("Shopify app embed initialized successfully"),t}catch(e){return console.error("Error initializing Shopify app embed:",e),vn=!1,null}}(),console.log("Shopify embed initialized")}catch(e){console.error("Failed to initialize Shopify embed:",e)}else if(document.getElementById("ai-shopping-assistant")){console.log("Initializing chat widget in standalone mode");try{var n=ln();window.aiShopAssistant=n,console.log("Chat widget initialized and exposed as window.aiShopAssistant")}catch(e){console.error("Failed to initialize chat widget:",e)}}else console.log("Chat widget container not found in the DOM");window.testClaudeConnection=gn,console.log("AI Shopping application initialization completed")}catch(e){console.error("Error during application initialization:",e),wn=!1}}};"complete"===document.readyState||"interactive"===document.readyState?(console.log("Document is already ready, adding a small delay before initialization"),setTimeout(Sn,100)):(document.addEventListener("DOMContentLoaded",(function(){console.log("DOMContentLoaded fired, adding a small delay before initialization"),setTimeout(Sn,100)})),window.addEventListener("load",(function(){console.log("Window load event fired, checking if initialization has occurred"),window.aiShopAssistant||wn||(console.log("Application not yet initialized, running init"),setTimeout(Sn,100))})))})()})();